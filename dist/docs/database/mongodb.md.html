<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <link rel="stylesheet" type="text/css" href="/docs/markdown_res/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/markdown_res/bootstrap/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/markdown_res/css/github-markdown.css" />
    <link rel="stylesheet" type="text/css" href="/docs/markdown_res/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="/docs/markdown_res/css/page.css" />
    <script type="text/javascript" src="/docs/markdown_res/js/jquery-1.9.1.min.js"></script>
    <style type="text/css">

    </style>

</head>
<body class="markdown-body">
    <div id="nav" class="row">
<a class="text-info pull-right" href="javascript:history.back()">Back</a>
    </div>

<h1> MongoDB Memo</h1>
<blockquote><p> Agility, scalability, performance. Pick three. 敏捷，扩展性，性能。三者皆得。</p></blockquote><ul><li>Main: https://www.mongodb.org</li>
<li>Install: http://docs.mongodb.org/manual/installation/</li>
<li>Drivers: https://docs.mongodb.org/ecosystem/drivers/</li>
<li><code>Docs</code>: http://docs.mongodb.org/manual/</li></ul>
<h2> 评价</h2>

<p>MongoDB是一个<code>面向文档</code>的数据库，目前由<code>10gen</code>开发并维护，它的功能丰富，齐全，所以完全可以替代MySQL。
与MySQL等关系型数据库相比，MongoDB的<code>优点</code>如下：</p>
<ul><li>弱一致性，更能保证用户的访问速度。</li>
<li>文档结构的存储方式，能够更便捷的获取数据。</li>
<li>内置<code>GridFS</code>，支持大容量的存储。</li>
<li>内置Sharding。</li>
<li>第三方支持丰富。（这是与其他的NoSQL相比，MongoDB也具有的优势）</li>
<li>性能优越</li></ul>
<h2> 特点介绍</h2>
<ul><li><code>JSON</code>风格语法，MongoDB中的JSON文档称其为<code>BSON</code>，是JSON的二进制表达方式。</li>
<li><code>面向文档</code>：<code>Documents</code>类似于编程语言中的<code>结构体</code>，保存<code>key-value</code> pairs。</li>
<li><code>Collection</code>：集合，包含多个Document，类似于Table</li></ul>
<h2> 安装</h2>

<p><code>普通青年</code>，HomeBrew安装：</p>
<pre><code># 更新brew packages database
$ brew update
$ brew install mongodb </code></pre>
<p>另：</p>
<pre><code># 支持TLS/SSL
$ brew install mongodb --with-openssl
# 安装最新的开发版本
$ brew install mongodb --devel  </code></pre>
<p><code>文艺青年</code>，二进制包安装：</p>
<ul><li>下载二进制包</li>
<li>解压至你希望的有权限的任何目录</li>
<li>添加<code>PATH</code></li></ul>
<h2> 使用</h2>
<ol><li>建立数据目录 <pre><code>$ mkdir -p /path/to/db/data </code></pre>
<p><code>默认的</code>mongodb数据文件目录是<code>/data/db</code></p>
<pre><code>$ mkdir -p /data/db </code></pre>
<p>如果不是使用默认目录，则需要在启动时使用<code>--dbpath</code>选项传入</p>
</li>
<li>check： 确保启动mongodb的用户对数据目录有<code>读写权限</code></li>
<li>启动<pre><code>$ mongod </code></pre>
<p>如果自定义数据目录：</p>
<pre><code>$ mongod --dbpath /path/to/db/data </code></pre>
<p>配置文件： </p>
<pre><code>$ mongod --config /usr/local/etc/mongod.conf </code></pre>
<p>自定义端口：</p>
<pre><code>$ mongod --port 27017  </code></pre>
</li>
<li>交互命令行<pre><code>$ mongo   </code></pre>
</li></ol>
<h2> CRUD操作</h2>
<p>查看<a href="./mongodb-curd.md.html">MongoDB CURDs</a></p>

<h2> Operators操作符</h2>
<p>DOCs: http://docs.mongodb.org/manual/reference/operator/</p>
<p><code>4大类</code>：</p>
<ol><li>Query and Projection Operators<p>查看<a href="./mongodb-operators.md.html">MongoDB Operators</a></p>
</li>
<li>Update Operators<p>Update operators are operators that enable you to modify the data in your database or add additional data.</p>
</li>
<li>Aggregation Pipeline Operators<p>Aggregation pipeline operations have a collection of operators available to define and manipulate documents in pipeline stages.</p>
</li>
<li>Query Modifiers<p>Query modifiers determine the way that queries will be executed.</p>
</li></ol>
<h2> MongoDB Shell</h2>

<a href="./mongodb-shell.md.html">MongoDB Shell Memo</a>




<h3> 索引</h3>
<p>MongoDB默认在创建collection时添加<code>_id</code>索引字段</p>
<p>后续可以使用<code>createIndex()</code>创建collection的索引字段</p>
<ol><li>单字段索引<pre><code>$ db.restaurants.createIndex( { "cuisine": 1 } )
{
    "createdCollectionAutomatically" : false,
    "numIndexesBefore" : 1,
    "numIndexesAfter" : 2,
    "ok" : 1
}  </code></pre>
</li>
<li>复合索引<pre><code>$ db.restaurants.createIndex( { "cuisine": 1, "address.zipcode": -1 } )
{
   "createdCollectionAutomatically" : false,
   "numIndexesBefore" : 2,
   "numIndexesAfter" : 3,
   "ok" : 1
}      </code></pre>
</li></ol>
<h2> BSON Types</h2>
<blockquote><p> BSON是存储文档和RPC时使用的<code>二进制序列</code>化格式。MongoDB BSON provides support for additional data types than JSON.</p></blockquote>

<ul><li><code>BSON Types</code>: http://docs.mongodb.org/manual/reference/bson-types</li></ul>
<h3> 支持的BSON数据类型</h3>
<p>支持<code>20种</code>数据类型</p>


<h3> Comparison/Sort Order</h3>






<blockquote><p> MongoDB提供多种语言支持的<code>驱动器（Driver）</code></p></blockquote><h2> 与NodeJS的配合</h2>

<p>驱动器： <code>node-mongodb-native</code></p>
<ul><li><code>github</code>: https://github.com/mongodb/node-mongodb-native</li>
<li><code>docs</code>: http://mongodb.github.io/node-mongodb-native/2.0/api/</li></ul>
<h3> 连接数据库</h3>

<p>使用<code>MongoClient</code>：</p>
<pre><code>var MongoClient = require('mongodb').MongoClient,
    assert = require('assert');

// Connection URL
var url = 'mongodb://localhost:27017/myproject';
// Use connect method to connect to the Server
MongoClient.connect(url, function(err, db) {
    assert.equal(null, err);
    console.log("Connected correctly to server");

    db.close();
});   </code></pre>
<p><code>插入数据</code>：</p>
<pre><code>var insertDocuments = function(db, callback) {
    // Get the documents collection
    var collection = db.collection('documents');

    // Insert some documents
    collection.insert(
        [
            {a : 1}, {a : 2}, {a : 3}
        ]
        , function(err, result) {
            assert.equal(err, null);
            assert.equal(3, result.result.n);
            assert.equal(3, result.ops.length);
            console.log("Inserted 3 documents into the document collection");
            callback(result);
        }
    );
}  </code></pre>
<p><code>更新数据</code>：</p>
<pre><code>var updateDocument = function(db, callback) {
    // Get the documents collection
    var collection = db.collection('documents');
    // Update document where a is 2, set b equal to 1
    collection.update(
        { a : 2 }
        , { $set: { b : 1 } }
        , function(err, result) {
            assert.equal(err, null);
            assert.equal(1, result.result.n);
            console.log("Updated the document with the field a equal to 2");
            callback(result);
        }
    );  
}       </code></pre>

</body>
</html>
<script type="text/javascript" src="/docs/markdown_res/js/footer.js"></script>
<script type="text/javascript" src="/docs/markdown_res/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/docs/markdown_res/js/scrollspy.js"></script>
